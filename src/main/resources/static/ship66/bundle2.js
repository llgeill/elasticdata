!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=66)}([function(t,e,n){var i=n(25)("wks"),r=n(13),o=n(3).Symbol,s="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=i},function(t,e,n){t.exports=!n(2)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var i=n(3),r=n(18),o=n(7),s=n(9),a=n(26),l=function(t,e,n){var u,c,h,f,g=t&l.F,d=t&l.G,p=t&l.S,m=t&l.P,y=t&l.B,v=d?i:p?i[e]||(i[e]={}):(i[e]||{}).prototype,x=d?r:r[e]||(r[e]={}),w=x.prototype||(x.prototype={});for(u in d&&(n=e),n)h=((c=!g&&v&&void 0!==v[u])?v:n)[u],f=y&&c?a(h,i):m&&"function"==typeof h?a(Function.call,h):h,v&&s(v,u,h,t&l.U),x[u]!=h&&o(x,u,f),m&&w[u]!=h&&(w[u]=h)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){var i=n(8),r=n(43),o=n(19),s=Object.defineProperty;e.f=n(1)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(5),r=n(20);t.exports=n(1)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(6);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var i=n(3),r=n(7),o=n(10),s=n(13)("src"),a=n(68),l=(""+a).split("toString");n(18).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,n,a){var u="function"==typeof n;u&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(u&&(o(n,s)||r(n,s,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=n:a?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[s]||a.call(this)}))},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(14),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(22);t.exports=function(t){return Object(i(t))}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e){t.exports=!1},function(t,e,n){var i=n(49),r=n(35).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(50),r=n(22);t.exports=function(t){return i(r(t))}},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e,n){var i=n(6);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports={}},function(t,e,n){var i=n(8),r=n(71),o=n(35),s=n(34)("IE_PROTO"),a=function(){},l=function(){var t,e=n(44)("iframe"),i=o.length;for(e.style.display="none",n(72).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[o[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=i(t),n=new a,a.prototype=null,n[s]=t):n=l(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(18),r=n(3),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(15)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var i=n(27);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(14),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(5).f,r=n(10),o=n(0)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(21),r=n(0)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var i=n(39),r=n(20),o=n(17),s=n(19),a=n(10),l=n(43),u=Object.getOwnPropertyDescriptor;e.f=n(1)?u:function(t,e){if(t=o(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){"use strict";var i=n(8);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var i=n(17),r=n(11),o=n(28);t.exports=function(t){return function(e,n,s){var a,l=i(e),u=r(l.length),c=o(s,u);if(t&&n!=n){for(;u>c;)if((a=l[c++])!=a)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var i=n(25)("keys"),r=n(13);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){"use strict";var i=n(12),r=n(28),o=n(11);t.exports=function(t){for(var e=i(this),n=o(e.length),s=arguments.length,a=r(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,u=void 0===l?n:r(l,n);u>a;)e[a++]=t;return e}},function(t,e,n){var i=n(49),r=n(35);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){var i=n(21);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";var i=n(2);t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},function(t,e,n){"use strict";var i,r,o=n(32),s=RegExp.prototype.exec,a=String.prototype.replace,l=s,u=(i=/a/,r=/b*/g,s.call(i,"a"),s.call(r,"a"),0!==i.lastIndex||0!==r.lastIndex),c=void 0!==/()??/.exec("")[1];(u||c)&&(l=function(t){var e,n,i,r,l=this;return c&&(n=new RegExp("^"+l.source+"$(?!\\s)",o.call(l))),u&&(e=l.lastIndex),i=s.call(l,t),u&&i&&(l.lastIndex=l.global?i.index+i[0].length:e),c&&i&&i.length>1&&a.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i}),t.exports=l},function(t,e,n){"use strict";if(n(1)){var i=n(15),r=n(3),o=n(2),s=n(4),a=n(45),l=n(69),u=n(26),c=n(47),h=n(20),f=n(7),g=n(46),d=n(14),p=n(11),m=n(48),y=n(28),v=n(19),x=n(10),w=n(30),S=n(6),_=n(12),b=n(70),P=n(24),C=n(51),F=n(16).f,I=n(73),k=n(13),M=n(0),T=n(52),E=n(33),L=n(53),A=n(76),O=n(23),R=n(80),D=n(55),j=n(36),V=n(81),B=n(5),G=n(31),N=B.f,Z=G.f,z=r.RangeError,H=r.TypeError,U=r.Uint8Array,W=Array.prototype,q=l.ArrayBuffer,Y=l.DataView,$=T(0),K=T(2),X=T(3),J=T(4),Q=T(5),tt=T(6),et=E(!0),nt=E(!1),it=A.values,rt=A.keys,ot=A.entries,st=W.lastIndexOf,at=W.reduce,lt=W.reduceRight,ut=W.join,ct=W.sort,ht=W.slice,ft=W.toString,gt=W.toLocaleString,dt=M("iterator"),pt=M("toStringTag"),mt=k("typed_constructor"),yt=k("def_constructor"),vt=a.CONSTR,xt=a.TYPED,wt=a.VIEW,St=T(1,(function(t,e){return Ft(L(t,t[yt]),e)})),_t=o((function(){return 1===new U(new Uint16Array([1]).buffer)[0]})),bt=!!U&&!!U.prototype.set&&o((function(){new U(1).set({})})),Pt=function(t,e){var n=d(t);if(n<0||n%e)throw z("Wrong offset!");return n},Ct=function(t){if(S(t)&&xt in t)return t;throw H(t+" is not a typed array!")},Ft=function(t,e){if(!S(t)||!(mt in t))throw H("It is not a typed array constructor!");return new t(e)},It=function(t,e){return kt(L(t,t[yt]),e)},kt=function(t,e){for(var n=0,i=e.length,r=Ft(t,i);i>n;)r[n]=e[n++];return r},Mt=function(t,e,n){N(t,e,{get:function(){return this._d[n]}})},Tt=function(t){var e,n,i,r,o,s,a=_(t),l=arguments.length,c=l>1?arguments[1]:void 0,h=void 0!==c,f=I(a);if(null!=f&&!b(f)){for(s=f.call(a),i=[],e=0;!(o=s.next()).done;e++)i.push(o.value);a=i}for(h&&l>2&&(c=u(c,arguments[2],2)),e=0,n=p(a.length),r=Ft(this,n);n>e;e++)r[e]=h?c(a[e],e):a[e];return r},Et=function(){for(var t=0,e=arguments.length,n=Ft(this,e);e>t;)n[t]=arguments[t++];return n},Lt=!!U&&o((function(){gt.call(new U(1))})),At=function(){return gt.apply(Lt?ht.call(Ct(this)):Ct(this),arguments)},Ot={copyWithin:function(t,e){return V.call(Ct(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return J(Ct(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return j.apply(Ct(this),arguments)},filter:function(t){return It(this,K(Ct(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Q(Ct(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(Ct(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){$(Ct(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(Ct(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(Ct(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ut.apply(Ct(this),arguments)},lastIndexOf:function(t){return st.apply(Ct(this),arguments)},map:function(t){return St(Ct(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return at.apply(Ct(this),arguments)},reduceRight:function(t){return lt.apply(Ct(this),arguments)},reverse:function(){for(var t,e=Ct(this).length,n=Math.floor(e/2),i=0;i<n;)t=this[i],this[i++]=this[--e],this[e]=t;return this},some:function(t){return X(Ct(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ct.call(Ct(this),t)},subarray:function(t,e){var n=Ct(this),i=n.length,r=y(t,i);return new(L(n,n[yt]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,p((void 0===e?i:y(e,i))-r))}},Rt=function(t,e){return It(this,ht.call(Ct(this),t,e))},Dt=function(t){Ct(this);var e=Pt(arguments[1],1),n=this.length,i=_(t),r=p(i.length),o=0;if(r+e>n)throw z("Wrong length!");for(;o<r;)this[e+o]=i[o++]},jt={entries:function(){return ot.call(Ct(this))},keys:function(){return rt.call(Ct(this))},values:function(){return it.call(Ct(this))}},Vt=function(t,e){return S(t)&&t[xt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Bt=function(t,e){return Vt(t,e=v(e,!0))?h(2,t[e]):Z(t,e)},Gt=function(t,e,n){return!(Vt(t,e=v(e,!0))&&S(n)&&x(n,"value"))||x(n,"get")||x(n,"set")||n.configurable||x(n,"writable")&&!n.writable||x(n,"enumerable")&&!n.enumerable?N(t,e,n):(t[e]=n.value,t)};vt||(G.f=Bt,B.f=Gt),s(s.S+s.F*!vt,"Object",{getOwnPropertyDescriptor:Bt,defineProperty:Gt}),o((function(){ft.call({})}))&&(ft=gt=function(){return ut.call(this)});var Nt=g({},Ot);g(Nt,jt),f(Nt,dt,jt.values),g(Nt,{slice:Rt,set:Dt,constructor:function(){},toString:ft,toLocaleString:At}),Mt(Nt,"buffer","b"),Mt(Nt,"byteOffset","o"),Mt(Nt,"byteLength","l"),Mt(Nt,"length","e"),N(Nt,pt,{get:function(){return this[xt]}}),t.exports=function(t,e,n,l){var u=t+((l=!!l)?"Clamped":"")+"Array",h="get"+t,g="set"+t,d=r[u],y=d||{},v=d&&C(d),x=!d||!a.ABV,_={},b=d&&d.prototype,I=function(t,n){N(t,n,{get:function(){return function(t,n){var i=t._d;return i.v[h](n*e+i.o,_t)}(this,n)},set:function(t){return function(t,n,i){var r=t._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),r.v[g](n*e+r.o,i,_t)}(this,n,t)},enumerable:!0})};x?(d=n((function(t,n,i,r){c(t,d,u,"_d");var o,s,a,l,h=0,g=0;if(S(n)){if(!(n instanceof q||"ArrayBuffer"==(l=w(n))||"SharedArrayBuffer"==l))return xt in n?kt(d,n):Tt.call(d,n);o=n,g=Pt(i,e);var y=n.byteLength;if(void 0===r){if(y%e)throw z("Wrong length!");if((s=y-g)<0)throw z("Wrong length!")}else if((s=p(r)*e)+g>y)throw z("Wrong length!");a=s/e}else a=m(n),o=new q(s=a*e);for(f(t,"_d",{b:o,o:g,l:s,e:a,v:new Y(o)});h<a;)I(t,h++)})),b=d.prototype=P(Nt),f(b,"constructor",d)):o((function(){d(1)}))&&o((function(){new d(-1)}))&&R((function(t){new d,new d(null),new d(1.5),new d(t)}),!0)||(d=n((function(t,n,i,r){var o;return c(t,d,u),S(n)?n instanceof q||"ArrayBuffer"==(o=w(n))||"SharedArrayBuffer"==o?void 0!==r?new y(n,Pt(i,e),r):void 0!==i?new y(n,Pt(i,e)):new y(n):xt in n?kt(d,n):Tt.call(d,n):new y(m(n))})),$(v!==Function.prototype?F(y).concat(F(v)):F(y),(function(t){t in d||f(d,t,y[t])})),d.prototype=b,i||(b.constructor=d));var k=b[dt],M=!!k&&("values"==k.name||null==k.name),T=jt.values;f(d,mt,!0),f(b,xt,u),f(b,wt,!0),f(b,yt,d),(l?new d(1)[pt]==u:pt in b)||N(b,pt,{get:function(){return u}}),_[u]=d,s(s.G+s.W+s.F*(d!=y),_),s(s.S,u,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*o((function(){y.of.call(d,1)})),u,{from:Tt,of:Et}),"BYTES_PER_ELEMENT"in b||f(b,"BYTES_PER_ELEMENT",e),s(s.P,u,Ot),D(u),s(s.P+s.F*bt,u,{set:Dt}),s(s.P+s.F*!M,u,jt),i||b.toString==ft||(b.toString=ft),s(s.P+s.F*o((function(){new d(1).slice()})),u,{slice:Rt}),s(s.P+s.F*(o((function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()}))||!o((function(){b.toLocaleString.call([1,2])}))),u,{toLocaleString:At}),O[u]=M?k:T,i||M||f(b,dt,T)}}else t.exports=function(){}},function(t,e,n){t.exports=!n(1)&&!n(2)((function(){return 7!=Object.defineProperty(n(44)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(6),r=n(3).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){for(var i,r=n(3),o=n(7),s=n(13),a=s("typed_array"),l=s("view"),u=!(!r.ArrayBuffer||!r.DataView),c=u,h=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(i=r[f[h++]])?(o(i.prototype,a,!0),o(i.prototype,l,!0)):c=!1;t.exports={ABV:u,CONSTR:c,TYPED:a,VIEW:l}},function(t,e,n){var i=n(9);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(14),r=n(11);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=r(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var i=n(10),r=n(17),o=n(33)(!1),s=n(34)("IE_PROTO");t.exports=function(t,e){var n,a=r(t),l=0,u=[];for(n in a)n!=s&&i(a,n)&&u.push(n);for(;e.length>l;)i(a,n=e[l++])&&(~o(u,n)||u.push(n));return u}},function(t,e,n){var i=n(21);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(10),r=n(12),o=n(34)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var i=n(26),r=n(50),o=n(12),s=n(11),a=n(74);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,h=6==t,f=5==t||h,g=e||a;return function(e,a,d){for(var p,m,y=o(e),v=r(y),x=i(a,d,3),w=s(v.length),S=0,_=n?g(e,w):l?g(e,0):void 0;w>S;S++)if((f||S in v)&&(m=x(p=v[S],S,y),t))if(n)_[S]=m;else if(m)switch(t){case 3:return!0;case 5:return p;case 6:return S;case 2:_.push(p)}else if(c)return!1;return h?-1:u||c?c:_}}},function(t,e,n){var i=n(8),r=n(27),o=n(0)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||null==(n=i(s)[o])?e:r(n)}},function(t,e,n){var i=n(0)("unscopables"),r=Array.prototype;null==r[i]&&n(7)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e,n){"use strict";var i=n(3),r=n(5),o=n(1),s=n(0)("species");t.exports=function(t){var e=i[t];o&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(6),r=n(57).set;t.exports=function(t,e,n){var o,s=e.constructor;return s!==n&&"function"==typeof s&&(o=s.prototype)!==n.prototype&&i(o)&&r&&r(t,o),t}},function(t,e,n){var i=n(6),r=n(8),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(26)(Function.call,n(31).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){var i=n(6),r=n(21),o=n(0)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e,n){var i=n(4),r=n(22),o=n(2),s=n(88),a="["+s+"]",l=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),c=function(t,e,n){var r={},a=o((function(){return!!s[t]()||"​"!="​"[t]()})),l=r[t]=a?e(h):s[t];n&&(r[n]=l),i(i.P+i.F*a,"String",r)},h=c.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=c},function(t,e,n){"use strict";var i=n(99)(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},function(t,e,n){"use strict";var i=n(30),r=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},function(t,e,n){"use strict";n(100);var i=n(9),r=n(7),o=n(2),s=n(22),a=n(0),l=n(41),u=a("species"),c=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var f=a(t),g=!o((function(){var e={};return e[f]=function(){return 7},7!=""[t](e)})),d=g?!o((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[u]=function(){return n}),n[f](""),!e})):void 0;if(!g||!d||"replace"===t&&!c||"split"===t&&!h){var p=/./[f],m=n(s,f,""[t],(function(t,e,n,i,r){return e.exec===l?g&&!r?{done:!0,value:p.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}})),y=m[0],v=m[1];i(String.prototype,t,y),r(RegExp.prototype,f,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},function(t,e,n){var i=n(3),r=n(18),o=n(15),s=n(64),a=n(5).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,n){e.f=n(0)},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";n.r(e);n(67),n(82),n(84),n(85),n(86),n(87),n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(101),n(102),n(105),n(106),n(107),n(111);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==i(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){n(3),n(9),n(10),function(t){function e(t,e){var n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,o=t[1]*n+t[0]*i;return t[0]=r,t[1]=o,t}function n(t,e){return t[0]*=e,t[1]*=e,t}function r(t,e){var n=t[0].style.transform.replace("matrix(","").replace(")","").split(",");n[4]=-e[0],n[5]=e[1],t[0].style.transform=function(t){return"matrix("+t.join(",")+")"}(n)}function o(t){return 1-function(t){return Math.pow(t,3)}(1-t)}ol.interaction.DragPan.prototype.handleDragEvent=function(t){var i=function(t){for(var e=t.length,n=0,i=0,r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return[n/e,i/e]}(this.targetPointers);if(this.panning_||(this.panning_=!0,this.lastCentroid=i,this.getMap().getView().beginInteraction()),this.getMap().isMoving=1==this.lastPointersCount_,1==this.lastPointersCount_&&this.targetPointers.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var o=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],s=t.map,a=s.getView();if(s.noRenderOnMoving){for(var l=0;l<s.renderer_.children_.length;l++)r($($("canvas",s.renderer_.children_[l])),o);this.lastPoint=i}else n(o,a.getResolution()),e(o,a.getRotation()),a.adjustCenterInternal(o),this.lastCentroid=i}}else this.kinetic_&&this.kinetic_.begin();this.lastPointersCount_=this.targetPointers.length,t.originalEvent.preventDefault()},ol.interaction.DragPan.prototype.handleUpEvent=function(t){var i=t.map,s=i.getView();if(0===this.targetPointers.length){if(this.panning_){if(this.panning_=!1,i.noRenderOnMoving&&this.lastCentroid&&this.lastPoint){var a=this.lastPoint,l=[this.lastCentroid[0]-a[0],a[1]-this.lastCentroid[1]];n(l,s.getResolution()),e(l,s.getRotation());for(var u=0;u<i.renderer_.children_.length;u++)r($($("canvas",i.renderer_.children_[u])),[0,0]);this.getMap().isMoving=!1,s.adjustCenterInternal(l),this.lastCentroid=a}s.endInteraction()}if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var c=this.kinetic_.getDistance(),h=this.kinetic_.getAngle(),f=s.getCenterInternal(),g=i.getPixelFromCoordinateInternal(f),d=i.getCoordinateFromPixelInternal([g[0]-c*Math.cos(h),g[1]-c*Math.sin(h)]);s.animateInternal({center:s.getConstrainedCenter(d),duration:500,easing:o})}return!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},ol.View.prototype.adjustResolutionInternal=function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,n);r<this.minResolution_&&(r=this.minResolution_),r>this.maxResolution_&&(r=this.maxResolution_),this.targetResolution_=r,e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.applyTargetState_()};var s,a={sources:{MT_GOOGLE:"https://mt2.google.cn/vt?lyrs=m@180000000&hl=zh-CN&gl=CN&s=Gal&x={x}&y={y}&z={z}",MT_GOOGLESAT:"https://www.google.cn/maps/vt?lyrs=s@802&gl=cn&x={x}&y={y}&z={z}"},support:{SHIPS66_SHIP:"https://g3.ships66.com/{z}/{z}/{x}-{y}.png"},controls:{},theme:{},renderers:{},version:"",author:"",email:"",datas:{},plugins:{init:function(){}},utils:{gzip:function(t){var e,n=atob(t).split("").map((function(t){return t.charCodeAt(0)})),i=new Uint8Array(n),r=pako.inflate(i),o="";for(e=0;e<r.length/8192;e++)o+=String.fromCharCode.apply(null,r.slice(8192*e,8192*(e+1)));return o+=String.fromCharCode.apply(null,r.slice(8192*e)),decodeURIComponent(escape(o))}},format:new ol.format.WKT,layers:{},telephone:"",isIdle:!0,codingCoordinate:!0,mecaterHalfWidth:20037508.342789244,extends:(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),loadSupports:function(t,e,n,i){for(var r={},o=0;o<t.length;o++){var s=t[o],a=this.support[s],l=extend({name:s,zIndex:(n||0)+o},e),u=extend({},i);r[s]=this.loadTileSetting(a,l,u)}return r},changeSource:function(t,e,n){for(var i=t.getLayers().getArray(),r=0;r<i.length;r++)if(i[r].get("name")==e){var o=i[r].get("urls")[n];if(null==o)o=n;else{var s=i[r].get("noParseCoordinate").indexOf(n)<0;if(s!=a.codingCoordinate){a.codingCoordinate=s;for(var l=0;l<i.length;l++)i[l].changeCoding&&i[l].changeCoding(s)}}return"string"==typeof o?i[r].getSource().setUrl(o):i[r].getSource().setUrls(o.urls),i[r]}},setCookie:function(t,e,n){var i=new Date;n?i.setTime(i.getTime()+1e3*n):i.setTime(i.getTime()+2592e6),document.cookie=escape(t)+"="+encodeURIComponent(escape(e))+";path=/;expires="+i.toGMTString()},loadSources:function(t,e){var n,i,r={};!this.sources[e.default]&&t.indexOf(e.default)<0&&(e.default=t[0],a.setCookie("_elane_maptype",e.default));for(var o=0;o<t.length;o++){var s=t[o];0==o&&(i=s,this.sources[e.default]&&(i=e.default),n=this.sources[i]),r[s]=this.sources[s]}var l=extend({noParseCoordinate:["MT_OSM","MT_CNMAP"],name:"basemap"},e,{urls:r});return a.codingCoordinate=l.noParseCoordinate.indexOf(i)<0,this.loadTileSetting(n,l,"string"==typeof n?null:n)},loadTileSetting:function(t,e,n){var i=getParams("string"==typeof t?t:t.urls[0]),r=1;i.scale&&(r=i.scale);var o=extend({urls:"string"==typeof t?[t]:t.urls,tilePixelRatio:r},n),s=new ol.source.XYZ(o);return extend({},{minZoom:2,maxZoom:18,minZ:2,maxZ:18},{source:s},e)},getOtherLayer:function(t,e){for(var n=t.getLayers().getArray(),i=0;i<n.length;i++)if(n[i].get("name")==e)return n[i];return null},wrapLonLat:function(t){return this.wrapCoordinate(t,"EPSG:4326")},wrapProjection:function(t){return this.wrapCoordinate(t,"EPSG:3857")},wrapCoordinate:function(t,e){return null==e||e.indexOf("4326")>=0?this.toLonLat(this.fromLonLat(t)):this.fromLonLat(this.toLonLat(t))},wrapCoordinates:function(t,e){for(var n=[],r=0;r<t.length;r++)"object"==i(t[r][0])?n[r]=this.wrapCoordinates(t[r],e):n[r]=this.wrapCoordinate(t[r],e);return n},wrapGeometry:function(t,e){var n,r=t.getCoordinates();return n="object"==i(r[0])?this.wrapCoordinates(r,e):this.wrapCoordinate(r,e),t.setCoordinates(n),t},wrapExtent:function(t,e){for(var n=[],i=0;i<t.length;i+=2){var r=this.wrapCoordinate([t[i],t[i+1]],e);n[i]=r[0],n[i+1]=r[1]}return n},getWrapExtent:function(t){return this.wrapExtent(t.getView().calculateExtent(),t.getView().getProjection().getCode())},LatLngInRegion:function(t,e){return!(!t||!e)&&e.containsXY(t[0],t[1])},decodeCoordinate:function(t,e){return this.codingCoordinate&&this.LatLngInRegion(t,e)?GPS.gcj_decrypt(t):t},encodeCoordinate:function(t,e){return this.codingCoordinate&&this.LatLngInRegion(t,e)?GPS.gcj_encrypt(t):t},judgeShipDirect:function(t,e,n){var i="";return t&&1*t>1&&(i=null!=e&&1*e!=511&&null!=n?1*n-1*e>=3?"left":1*n-1*e<=-3?"right":"front":"front"),i},getCnMap:function(t){var e=(window.location.protocol.indexOf("file:")>-1?"https:":window.location.protocol)||"https:",n=window.location.protocol.indexOf("file:")>-1?"https://www.ships66.com":window.location.origin;a.getServerData({successCallback:function(e){var n=e.data.second;a.addCNMap(n,t),a.cnMapTime=e.data.first+e.expire},type:"get",data:null,url:e+"//www.ships66.com/account/thirdToken/s100?url="+n})},addCNMap:function(t,e){if(e.map)for(var n=map.getLayers().getArray(),i=0;i<n.length;i++)"MT_CNMAP"==n[i].get("name")&&e.map.removeLayer(n[i]);var r=extend({},{minZoom:5,maxZoom:15,visible:!1},e);delete r.map,a.support.MT_CNMAP="http://101.230.249.90:7002/OneMapServer/rest/services/globe_seamap/MapServer/tile/{z}/{y}/{x}?scale=2&token="+t;var o=a.loadSupports(["MT_CNMAP"],r,1),s=new ol.layer.Tile(o.MT_CNMAP);null==r.map&&map.addLayer(s)},getShipAngle:function(t){return t.speed&&t.speed>1&&t.speed<102.3||null==t.hdg||511==t.hdg||0==t.hdg?t.cog?t.cog:0:t.hdg},getLayersInfo:function(e){for(var n=t.map.getLayers().array_,i=0;i<n.length;i++)if(e==n[i].values_.name)return n[i];return null},getServerData:function(t){"/ais/getAisInfo"==t.url&&params.dev&&t.url;var e=extend({},t,{success:function(t){if(t.data&&("string"==typeof t.data?t.data=JSON.parse(a.utils.gzip(t.data)):"string"==typeof t.data[0]&&(t.data=JSON.parse(a.utils.gzip(t.data[0]))),null==t.result&&(t.result=!0)),e.keymap&&t.map){for(var n=[],i=0;i<t.data.length;i++){for(var r={},o=0;o<t.map.length;o++){var s=e.keymap[t.map[o]];s?r[s]=t.data[i][o]:r[t.map[o]]=t.data[i][o]}n.push(r)}delete t.map,t.data=n}e.successCallback&&e.successCallback(t)},error:function(t){"abort"!=t.statusText&&(debug("出错了",t),e.errorCallback&&e.errorCallback(t))}});window.getServerData(e)},extentToRing:function(t,e){return 0==e?[ol.extent.getBottomLeft(t),ol.extent.getBottomRight(t),ol.extent.getTopRight(t),ol.extent.getTopLeft(t)]:[ol.extent.getBottomLeft(t),ol.extent.getTopLeft(t),ol.extent.getTopRight(t),ol.extent.getBottomRight(t)]},combineExtent:function(t,e){if(e&&ol.extent.equals(t,e))return null;if(!e||!ol.extent.intersects(t,e))return ol.geom.Polygon.fromExtent(t);if(ol.extent.containsExtent(t,e))return new ol.geom.Polygon([ol.geom.Polygon.fromExtent(t).getCoordinates()[0],ol.geom.Polygon.fromExtent(e).getCoordinates()[0]]);if(ol.extent.containsExtent(e,t))return null;for(var n=ol.extent.getIntersection(t,e),i=new Ring(a.extentToRing(n)),r=[],o=new Ring(a.extentToRing(t)),s=o.data.length-1;s>=0;s--)ol.extent.containsCoordinate(n,o.data[s])&&r.push(s);switch(r.length){case 1:var l=o.data[r[0]],u=i.data[r[0]+2]||i.data[r[0]-2];if(1==r[0]||3==r[0])o.data.splice(r[0],1,[l[0],u[1]],u,[u[0],l[1]]);else try{o.data.splice(r[0],1,[u[0],l[1]],u,[l[0],u[1]])}catch(t){debug().error("出错了",o,i,r,l,u,t)}return o.closeRing(),new ol.geom.Polygon([o.data]);case 2:return o.data.splice(r[0],1,i.data[(r[0]-1+4)%4]),o.data.splice(r[1],1,i.data[(r[1]+1)%4]),o.closeRing(),new ol.geom.Polygon([o.data]);case 3:case 4:default:ol.geom.Polygon.fromExtent(t)}},initMapEvents:function(t){function e(t){return function(e){if(e.dragging)return!0;if("moveend"==e.type){var n=e.map.getView().getCenter(),i=a.wrapProjection(n);if(n[0]<i[0]-10||n[0]>i[0]+10)return debug().warn("监测到地图离开世界范围，尝试修正",n,i),i[0]==Number.NaN||i[1]==Number.NaN?e.map.getView().setCenter(a.fromLonLat([119,26])):e.map.getView().setCenter(i),!1}for(var r=e.map.getLayers().getArray().sort((function(t,e){return t.get("zIndex")-e.get("zIndex")})),o=r.length-1;o>=0;o--){var s=r[o];if(s[t]&&(s._map||(s._map=e.map),!1===s[t](e)))return!1}}}t.on("moveend",e("reset")),t.on("pointermove",e("onMousemove")),t.on("pointerdrag",e("onDragging")),t.on("singleclick",e("onClick"))},transformExtentToPixel:function(t,e){var n=t.getPixelFromCoordinate([e[0],e[1]]),i=t.getPixelFromCoordinate([e[2],e[3]]);return[n[0],i[1],i[0],n[1]]},transformExtentFromPixel:function(t,e){var n=t.getCoordinateFromPixel([e[0],e[1]]),i=t.getCoordinateFromPixel([e[2],e[3]]);return[n[0],i[1],i[0],n[1]]},addExtent:function(t,e){return 2==e.length?[t[0]-e[0],t[1]-e[1],t[2]+e[0],t[3]+e[1]]:[t[0]+e[0],t[1]+e[1],t[2]+e[2],t[3]+e[3]]},translateExtent:function(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[0],t[3]+e[1]]},calcLabel:function(t,e,n,i,r,o){var s=t._ctx;s.save(),e.font&&(s.font=e.font);var a=s.measureText(i).width+2*e.labelOutSize;return s.restore(),ShipUtils.askLabelSpace(n,a,e.labelHeight+2*e.labelOutSize,t._map.labels,r||20,!0,o||20)},fromLonLat:function(t){return ol.proj.fromLonLat(t)},toLonLat:function(t){return ol.proj.toLonLat(t)},fromLonLats:function(t){for(var e=[],n=0;n<t.length;n++)e[n]=this.fromLonLat(t[n]);return e},toLonLats:function(t){for(var e=[],n=0;n<t.length;n++)e[n]=this.toLonLat(t[n]);return e},cjLayer:function(){var t=ol.proj.get("EPSG:4326"),e=new ol.tilegrid.TileGrid({tileSize:256,origin:[-400,400],extent:[103.87588002846373,27.45228966609097,121.40686460052386,33.24664597260153],resolutions:[.023794610058302804,.00951784402332112,.00475892201166056,.00237946100583028,.00118973050291514,.00059486525145757,.000297432625728785,.0001487163128643925,7435815643219625e-20,37179078216098126e-21,1859072883855198e-20,9294174688773075e-21,4647087344386537e-21,237946100583028e-20]}),n=new ol.source.XYZ({tileGrid:e,projection:t,url:"http://g3.ships66.com/maps/cjenc?z={z}&x={y}&y={x}&vali=false",name:"cj"});return[new ol.layer.Tile({source:n,minZoom:9,name:"cjtype"})]},extentToWKT:function(t,e,n){var i=new ol.geom.Polygon(t.data);if(n){var r=ol.geom.MultiPolygon();e.bbox=format.writeGeometry(r)}else e.bbox=format.writeGeometry(i);return delete e.vertices,e},flyTo:function(t,e,n){var i=extend({},{per_duration:300,callback:function(t,e,n){debug().log("飞行结束...",t,e,n)}},n),r=e;if(e.getType)switch(e.getType()){case"Point":r=e.getCoordinates();break;default:r=e.getCenter()}var o=ol.sphere.getDistance(a.toLonLat(t.getView().getCenter()),a.toLonLat(r),6378137)/t.getView().getResolution()/256,s=1;o>4&&(s=3);for(var l=t.getView().getMinZoom(),u=t.getView().getZoom(),c=0,h=0;u-h>=l;h++)if(Math.pow(2,h+l)>o){c=h;break}if(3==s){var f=extend(i,{duration:i.per_duration*c,zoom:u-c});t.getView().animate(f,(function(){var n=extend(i,{duration:i.per_duration*(o/Math.pow(2,c)),center:r});t.getView().animate(n,(function(){var n=extend(i,{duration:i.per_duration*c});t.getView().fit(e,n)}))}))}else i.duration=i.per_duration*o,debug().log("水平飞行,飞行时间为",i.duration),t.getView().fit(e,i)},getGeoLocation:function(t,e){var n=function(e){switch(e.code){case e.TIMEOUT:(new debug).error("A timeout occured! Please try again!");break;case e.POSITION_UNAVAILABLE:(new debug).error("We can't detect your location. Sorry!");break;case e.PERMISSION_DENIED:(new debug).error("Please allow geolocation access for this to work.");break;default:(new debug).error("An unknown error occured!",e)}t&&t(e)},i=function(e){null==e&&(new debug).error("定位功能只支持在https下访问，请访问https地址或做https支持！"),t&&t(e)};if(window.navigator.geolocation){var r=extend({enableHighAccuracy:!0,timeout:1e4,maximumAge:3e3},e);if(!0===r.keepWatch){var o=navigator.geolocation.watchPosition(i,n,r);(new debug).info("打开持续定位",o)}else navigator.geolocation.getCurrentPosition(i,n,r),(new debug).info("打开单次定位",o)}},showCityInfo:function(t,e){a.getGeoLocation((function(e){var n=t.getView().getZoom();if(n=n>=10?n:10,1==e.code)(new AMap.CitySearch).getLocalCity((function(e,i){if("complete"===e&&"OK"===i.info&&i&&i.city&&i.bounds){var r=i.city,o=i.bounds;return debug().log(r,o.getCenter()),t.getView().setCenter(a.fromLonLat([o.getCenter().lng,o.getCenter().lat])),t.getView().setZoom(n),a.fromLonLat([o.getCenter().lng,o.getCenter().lat])}}));else{if(null!=e.coords&&null!=e.coords.longitude&&null!=e.coords.latitude)return t.getView().setCenter(a.fromLonLat([e.coords.longitude,e.coords.latitude])),t.getView().setZoom(n),a.fromLonLat([e.coords.longitude,e.coords.latitude]);(new debug).warn("定位失败",e)}}),{keepWatch:e})}};t.ships=a,a.idle=new Idle}(window)},function(t,e,n){n(4),n(5),n(7),n(6),function(t){var e=ol.layer.Vector;function n(n){this.adaptationPixelRatio=function(){this._pixelRatio&&this._ctx.scale(this._pixelRatio,this._pixelRatio)},this.setting=extend({},{name:"renderLayer",maxZoom:18,minZoom:2,hover:!0,hoverDelay:1,duration:2e3,radius:5,showLabel:!0,viewOutSize:0,labelMinZoom:13,labelMaxZoom:18,labelOutSize:1,labelHeight:10,labelAlpha:.8,labelLineStyle:"black",textStyle:"#f6f6f6",textBackStyle:"black",selectedStyle:"red",stroke:!0,lineWeight:1,weight:1,opacity:1,strokeStyle:"blue",fillStyle:"rgb(2,254,3)",font:"600 12px Arial",renderOrder:function(t,e){return t.order||0-e.order||0}},n);var i=e.call(this,this.setting)||this;if(this.source=new ol.source.Vector({features:[]}),this.source.on("clear",(function(t){i.onClear&&i.onClear(t)})),this.setting.distance&&this.setting.cluster){var r=new ol.source.Cluster({distance:i.setting.distance,source:i.source});i.setSource(r)}else i.setSource(this.source);return this.on("prerender",(function(t){i.onPreRender&&i._map&&i.onPreRender(t)})),this.on("postrender",(function(t){i.onPostRender&&i._map&&i.onPostRender(t)})),this.checkZoom=function(t){if(t&&!this._map&&(this._map=t.map),this._map){var e=this._map.getView().getZoom();return this.setZoom(e),e>=this.getMinZoom()&&e<=this.getMaxZoom()}return!1},this._checkSelf=function(t,e){return!(!t||null==t.id_||t.id_!=e.id_)},this._checkSelfId=function(t,e){return!(!t||null==t.id_||t.id_!=e)},this.getMapExtent_=function(t){t&&!this._map&&t.map&&(this._map=t.map);var e=this._map.getView().calculateExtent(),n=this.get("viewOutSize");return e[0]=Math.floor(e[0]-n),e[1]=Math.floor(e[1]-n),e[2]=Math.ceil(e[2]+n),e[3]=Math.ceil(e[3]+n),e},this.getMapExtent=function(e,n,i){var r=this.getMapExtent_(),o=0,s=0;r[0]<this._map.getView().getProjection().extent_[0]&&(o=-360),r[2]>this._map.getView().getProjection().extent_[2]&&(s=360);for(var a=this._lastExtent,l=0;l<4;l+=2){var u=t.decodeCoordinate(t.toLonLat([r[l],r[l+1]]),t.geometrys.china);r[l]=u[0]+(0==l?o:s),r[l+1]=u[1]}var c=[];if(ol.extent.containsExtent([-180,-90,180,90],r))c=[{extent:r,oldextents:[a]}];else{var h=[];h[0]=ol.extent.getIntersection([-180,-90,180,90],r),h[1]=ol.extent.getIntersection([-540,-90,-180.000001,90],r),h[2]=ol.extent.getIntersection([180.000001,-90,540,90],r),n&&a&&(h[3]=ol.extent.getIntersection([-180,-90,180,90],a),h[4]=ol.extent.getIntersection([-540,-90,-180.000001,90],a),h[5]=ol.extent.getIntersection([180.000001,-90,540,90],a));var f=0;for(l=0;l<3;l++)if(h[l][0]!=1/0&&(c.push({extent:h[l],oldextents:[]}),n)){for(var g=3;g<6;g++)h[g]&&h[g][0]!=1/0&&c[f].oldextents.push(h[g]);f++}}var d=[];for(var f in c){var p=c[f].extent;if(n)if(c[f].oldextents.length>0)for(var m in c[f].oldextents){var y,v=c[f].oldextents[m];(y=t.combineExtent(p,v))&&d.push(y)}else d.push(new ol.geom.Polygon.fromExtent(p));else d.push(new ol.geom.Polygon.fromExtent(p))}if((i||n)&&(this._lastExtent=r),0!=d.length){var x=new ol.geom.MultiPolygon(d);return(x=t.wrapGeometry(x)).isCombine=n,x}return null},this.onClick=function(t){if(this.getVisible()&&this.checkZoom(t)){var e=this._findByPoint(t);if(null!=e)return this._map.selectedLayer=this.ol_uid,this._map.selectedFeature=e,t.feature=e,t.layer=this,this.changed(),t.type="click",this.dispatchEvent(t)}},this.onMousemove=function(t){if(!t.dragging&&this.getVisible()&&this.checkZoom(t)){var e=this._findByPoint(t);if(this._map.getTargetElement().style.cursor=null!=e?"pointer":"",!window.mobile&&this.get("hover")&&e)return this._checkSelf(this._map.lastOn,e)||(this._map.lastOn=e,this._map.lastOnLayer=this.ol_uid,t.feature=e,this.changed(),t.delay=this.get("hoverDelay"),this._hoverHandle(t)),!1}this.get("hover")&&this._map.lastOnLayer==this.ol_uid&&(null!=this._map.lastOn&&(this._hoverHandler&&(debug().log("悬停结束2",this.get("name"),this._map.lastOn),clearTimeout(this._hoverHandler),this._hoverHandler=null),this._map.lastOn=null,this.changed()),this.hoving&&(t.type="hoverEnd",t.layer=this,this.hoving=!1,this.dispatchEvent(t)))},this._renderCountChangedHandle=function(t){this.renderCount!=t.renderCount&&(t.type="renderCountChanged",this.renderCount=t.renderCount,this.dispatchEvent(t))},this._hoverHandle=function(t){if(this._hoverHandler&&(clearTimeout(this._hoverHandler),this._hoverHandler=null),!(t.delay>0))return this.hover(t);t.delay--,this._checkSelf(this._map.lastOn,t.feature)&&this._map.lastOnLayer==this.ol_uid&&(this._hoverHandler=setTimeout((function(){i._hoverHandle(t)}),1e3))},this.hover=function(t){return t.type="hover",t.layer=this,this.hoving=!0,this.dispatchEvent(t)},this.onPreRender=function(t){this._map||(this._map=t.map),this._ctx=t.context,this.renderingCount=0,this.renderSeq=(new Date).getTime(),this.currentExtent=this._map.getView().calculateExtent(),this.renderAreas=[0],this.currentExtent[0]<this._map.getView().getProjection().extent_[0]&&this.renderAreas.push(2*this._map.getView().getProjection().extent_[0]/this._map.getView().getResolution()),this.currentExtent[2]>this._map.getView().getProjection().extent_[2]&&this.renderAreas.push(2*this._map.getView().getProjection().extent_[2]/this._map.getView().getResolution()),this.beforeRender&&this.beforeRender(t)},this.getZoom=function(){return this.get("zoom")},this.setZoom=function(t){this.set("zoom",t)},this.findById=function(t){return this.source.getFeatureById(t)},this._findByPoint=function(e){var n=e.pixel,i=[n[0],n[1],n[0],n[1]],r=this.get("radius"),o=[r,r];this._hitHandle&&(o=this._hitHandle()),null!=this._pixelRatio&&(o=[o[0]*this._pixelRatio,o[1]*this._pixelRatio]),i=t.addExtent(i,o);var s=t.wrapExtent(e.frameState.extent,this._map.getView().getProjection().getCode()),a=t.transformExtentFromPixel(this._map,i),l=[];if(s[0]<s[2]&&e.frameState.extent[2]-e.frameState.extent[0]<2*this._map.getView().getProjection().extent_[2])a=ol.extent.getIntersection(s,a),l=this.source.getFeaturesInExtent(a);else{a=ol.extent.getIntersection(this._map.getView().calculateExtent(),a);var u=[];u[0]=ol.extent.getIntersection(this._map.getView().getProjection().extent_,a),u[1]=ol.extent.getIntersection([3*this._map.getView().getProjection().extent_[0],this._map.getView().getProjection().extent_[1],this._map.getView().getProjection().extent_[0]-1e-6,this._map.getView().getProjection().extent_[3]],a),u[2]=ol.extent.getIntersection([this._map.getView().getProjection().extent_[2]+1e-6,this._map.getView().getProjection().extent_[1],3*this._map.getView().getProjection().extent_[2],this._map.getView().getProjection().extent_[3]],a);for(var c=0;c<3;c++)u[c][0]!=1/0&&(l=l.concat(this.source.getFeaturesInExtent(t.wrapExtent(u[c],this._map.getView().getProjection().getCode()))))}if(this.get("renderOrder")&&(l=(l=l.sort(this.get("renderOrder"))).reverse()),!this.findFilter)return l&&l.length>0?l[0]:null;for(c=0;c<l.length;c++){var h=l[c];if(h){var f=this.findFilter(h,e);if(f)return f}}},this.calcAngle=function(t,e){var n=t[0]-e[0],i=t[1]-e[1];return Math.atan2(i,n)},this.drawPloygon=function(t,e,n,i,r,o,s,a,l,u){if(t){var c=this._ctx;c.save(),c.beginPath(),this.adaptationPixelRatio(),0!=o&&null==s&&c.rotate(o),r&&c.translate(r[0],r[1]),0!=o&&s&&c.rotate(o,s[0],s[1]),a&&c.scale(a,a),c.moveTo(t[0][0],t[0][1]);for(var h=1;h<t.length;h++)c.lineTo(t[h][0],t[h][1]);i||c.closePath(),e&&(c.strokeStyle=e,c.lineWidth=u||this.get("weight"),c.stroke()),n&&!i&&(l&&(c.globalAlpha=l),c.fillStyle=n,c.fill()),c.restore()}},this.drawPloyline=function(t,e,n,i,r,o,s){this.drawPloygon(t,e,null,!0,n,i,r,o,null,s)},this.drawLabel=function(e,n,i,r,o,s,a,l,u){var c=null;if(n&&e){var h=t.calcLabel(this,this.setting,e,n+(s?"88":""),a,l);if(h){if(this._map.labels.push(h),this.drawPloyline([e,h.x],i,null,null,null,null,u),o){var f=h.bounds;this.drawPloygon([ol.extent.getTopLeft(f),ol.extent.getTopRight(f),ol.extent.getBottomRight(f),ol.extent.getBottomLeft(f)],i,o,!1,null,null,null,null,this.get("labelAlpha"),u)}var g=this.get("labelHeight"),d=this.get("labelOutSize"),p=d;if(s){var m=h.l;p=g+2*d+1,f=[[m[0]-1,m[1]],[m[0]+p,m[1]],[m[0]+p,m[1]+p],[m[0]-1,m[1]+p]],this.drawPloygon(f,null,s),c={l:h.l,x:h.x}}this.drawText(n,[h.l[0]+p,h.l[1]+g+d],r)}}return c},this.drawPoint=function(t,e,n,i){var r=this._ctx;r.save(),r.beginPath(),this.adaptationPixelRatio(),r.arc(t[0],t[1],e,0,2*Math.PI),n&&(r.fillStyle=n,r.fill()),i&&(r.strokeStyle=i,r.lineWidth=this.get("weight"),r.stroke()),r.restore()},this.drawText=function(t,e,n,i){var r=this._ctx;r.save(),this.adaptationPixelRatio(),r.font=i||this.get("font"),n&&(r.fillStyle=n),r.fillText(t,e[0],e[1]),r.restore()},this.drawFontMarker=function(t,e,n,i,r,o,s){r&&this.drawPloygon(s||[[t[0]-e,t[1]-e],[t[0]-e,t[1]+e],[t[0]+e,t[1]+e],[t[0]+e,t[1]-e]],null,r,!1),this.drawText(decodeUnicode(n),[t[0]-e,t[1]+e],i,o||this.get("font"))},this.drawSelectedBounds=function(t,e,n,i,r){if(t){var o=ol.extent.getBottomLeft(t);this.drawPloyline([[o[0],o[1]+8],o,[o[0]+8,o[1]]],e,n,i,r),o=ol.extent.getBottomRight(t),this.drawPloyline([[o[0]-8,o[1]],o,[o[0],o[1]+8]],e,n,i,r),o=ol.extent.getTopRight(t),this.drawPloyline([[o[0]-8,o[1]],o,[o[0],o[1]-8]],e,n,i,r),o=ol.extent.getTopLeft(t),this.drawPloyline([[o[0],o[1]-8],o,[o[0]+8,o[1]]],e,n,i,r)}},this.drawArrow=function(t,e,n,i,r){this._ctx.save(),this._ctx.lineCap="round",this.drawPloygon(t,this.setting.labelLineStyle,this.setting.labelLineStyle,r,e,n,i),this._ctx.restore()},this.mathMatrixBounds=function(t,e){if(e>0){for(var n=(new Matrix).rotate(e,0,0,1),i=[ol.extent.getBottomLeft(t),ol.extent.getBottomRight(t),ol.extent.getTopRight(t),ol.extent.getTopLeft(t)],r=[0,0,0,0],o=0;o<i.length;o++)i[o]=n.transformCoordinate(i[o]),ol.extent.extend(r,[i[o][0],i[o][1],i[o][0],i[o][1]]);return r}return t},i}t.extends(n,e),t.layers.RenderLayer=n}(ships)},function(t,e){!function(t){Array.isArray||(Array.isArray=function(t){return null!=t&&null!=t.length}),t.ObjectSerialize=function(t,e){var n="",i=0;for(var r in t)0!=i&&(n+="&"),i++,null!=t[r]?n+=r+"="+(e?encodeURI(t[r]):encodeURIComponent(t[r])):n+=r+"=";return n},t.getParams=function(t){var e=getQueryString(t);return parseQueryString(e)},t.parseQueryString=function(t){var e={};if(t){for(var n=t.split("&"),i=0;i<n.length;i++){var r=n[i].split("=");if(""!=r[0]){var o=r[1];try{o=decodeURIComponent(r[1])}catch(t){}"false"===o&&(o=!1),"true"===o&&(o=!0),e[r[0]]=o}}e.token&&delete e.token}return e},t.getQueryString=function(t){return null==t&&(t=location.href),t.indexOf("?")>=0?t.substring(t.indexOf("?")+1):""},t.getPageAddress=function(t){return null==t&&(t=location.href),t.indexOf("?")>=0?t.substring(0,t.indexOf("?")):t},t.replaceQueryString=function(t,e,n,i,r){var o=getParams(t),s=extend(o,e);!1!==r&&(s._=(new Date).getTime());var a=ObjectSerialize(s,i);if(n)return a;var l=getPageAddress(t);return a?l+"?"+a:l},t.decodeUnicode=function(t){if(t&&0==t.indexOf("&#")){var e=t.replace("&#","0"),n=parseInt(e);return String.fromCharCode(n)}return t},t.encodeUnicode=function(){},t.String.prototype.urlFormat=function(t,e,n){var r=arguments;return"object"!=i(r[0])&&"function"!=typeof r[0]||(r=r[0]),this.replace(/\{(\w+)\}/gi,(function(t,i){var o=r[i];return null==o&&"string"==typeof i&&(o=r[i.toLowerCase()]),e||(o=encodeURI(decodeURI(o))),null==o&&(o=n?"{"+i+"}":""),o}))},t.String.prototype.format=function(t,e){var n=arguments;return"object"!=i(n[0])&&"function"!=typeof n[0]||(n=n[0]),this.replace(/\{(\w+)\}/gi,(function(t,i){var r=n[i];return null==r&&"string"==typeof i&&(r=n[i.toLowerCase()]),null!=r&&"undefined"!=r||(r=e?"":"{"+i+"}"),r}))},t.String.prototype.trim||(t.String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")}),t.String.Format=function(t,e){var n=arguments;if("string"==typeof t)return"object"==i(n[1])?t.format(n[1]):(e=Array.prototype.slice.call(n,1),String.prototype.format.call(t,e));throw Error("字符串格式化第一个参数是待格式化的格式内容")},"console"in t||(t.console={log:function(){}}),Date.prototype.format=function(t,e){if(e){var n=-60*/[+-]\d+/.exec(e);this.addMinutes(this.getTimezoneOffset()-n)}var i={"M+":this.getMonth()+1,"d+":this.getDate(),"D+":this.getDay(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S+":this.getMilliseconds(),"Z+":e||"UTC"+(this.getTimezoneOffset()<=0?"+":"")+this.getTimezoneOffset()/-60};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),i)if(new RegExp("("+r+")").test(t)){var o="00"+i[r];t=t.replace(RegExp.$1,1==RegExp.$1.length?i[r]:o.substr(o.length-RegExp.$1.length))}return t},Date.PerSecondTick=1e3,Date.PerMinuteTick=60*Date.PerSecondTick,Date.PerHourTick=60*Date.PerMinuteTick,Date.PerDayTick=24*Date.PerHourTick,Date.prototype.addSeconds=function(t){return 0!=t&&this.setTime(this.getTime()+t*Date.PerSecondTick),this},Date.prototype.addMinutes=function(t){return 0!=t&&this.setTime(this.getTime()+t*Date.PerMinuteTick),this},Date.prototype.addHours=function(t){return 0!=t&&this.setTime(this.getTime()+t*Date.PerHourTick),this},Date.prototype.addDays=function(t){return 0!=t&&this.setTime(this.getTime()+t*Date.PerDayTick),this},Date.prototype.addMonths=function(t){if(0!=t){var e=this.getMonth()+t,n=parseInt(e/12);this.addYears(n),this.setMonth(e%12)}return this},Date.prototype.addYears=function(t){return 0!=t&&this.setYear(this.getFullYear()+t),this},t.isArray=function(t){var e=Object.prototype.toString.call(t);return"[object Array]"===e||"[object Array Iterator]"===e},t.isObject=function(t,e){return t&&"object"==i(t)&&(!e||!isArray(t))};var e=function t(e,n,r){var o,s;for(s in"object"!=i(e)&&(e={}),n)n.hasOwnProperty(s)&&(o=n[s],isObject(o,!0)&&"number"!=typeof o.nodeType?e[s]=r?t(e[s]||{},o,r):o:e[s]=n[s]);return null==s&&null!=n&&n.test&&(e=n),e};t.merge=function(){var t,n,i=arguments,r={};for(!0===i[0]&&(r=i[1],i=Array.prototype.slice.call(i,2)),n=i.length,t=0;t<n;t++)r=e(r,i[t],!0);return r},t.extend=function(){for(var t=arguments,n=t[0],i=(t=Array.prototype.slice.call(t,1)).length,r=0;r<i;r++)n=e(n,t[r],!1);return n},t.params=getParams(),t.debug=function(){var e=(new Date).format("[yyyy-MM-dd HH:mm:ss,SSS]"),n=["log","error","info","warn"];for(var i in n)this[n[i]]=params.debug&&console[n[i]]?console[n[i]].bind(t.console,e):function(){};for(var i in n=["time","timeEnd"])this[n[i]]=params.debug&&console[n[i]]?console[n[i]].bind(t.console):function(){};return this};var n={callback:function(e,i){if(e.name){this.undoCallback(e);for(var o=[r,i,e],s=2;s<=arguments.length;s++)o.push(arguments[s]);n[e.name]=setTimeout.apply(t,o)}else setTimeout.apply(t,arguments),debug().error("无法注册匿名方法管理，如果需要进行管理，请先对callback的函数进行命名")}},r=function(t){delete n[t.name];for(var e=[],i=1;i<=arguments.length;i++)e.push(arguments[i]);t.apply(this,e)};n.undoCallback=function(t){t.name?n[t.name]&&(debug().warn("已经撤销了[{name}]上次回调申请".format(t)),clearTimeout(n[t.name]),n[t.name]=null,delete n[t.name]):debug().error("无法注册匿名方法管理，如果需要进行管理，请先对callback的函数进行命名")},t.CallbackFactory=n;var o={};t.getServerData=function(t){var e=extend({},{type:"post",async:!0,contentType:"application/x-www-form-urlencoded;charset=UTF-8"},t),n=new XMLHttpRequest;n.onloadend=function(t){var i=n.response;200==n.status&&("json"==n.dataType&&n.getResponseHeader("content-type").indexOf("application/json"),i=JSON.parse(i)),e.success(i,"success",t)},n.onerror=function(t){e.error(n.response,"error",t)},e.type&&"POST"!=e.type.toUpperCase()?e.url=replaceQueryString(e.url,e.data,null,null,e.cache):(e.url=replaceQueryString(e.url,{},null,null,e.cache),e.data&&"string"!=typeof e.data&&e.contentType.indexOf("application/x-www-form-urlencoded")>=0&&(e.data=ObjectSerialize(e.data))),n.open(e.type,e.url,e.async),e.contentType&&n.setRequestHeader("Content-type",e.contentType),n.send(e.data),!1!==e.enableCancel&&e.name&&(o[e.name]&&4!=o[e.name].readyState&&o[e.name].abort(),o[e.name]=n)},t._ctx,t.autoLetterSpace=function(e){t._ctx||(t._ctx=document.createElement("canvas").getContext("2d"));var n=$(e).text(),i=n.length;if(i>1){var r=$(e).width();t._ctx.save(),t._ctx.font=$(e).css("font");var o=(r-t._ctx.measureText(n).width)/(i-1);$(e).css({letterSpacing:o}),t._ctx.restore()}}}(window)},function(t,e,n){n(2),function(){function t(t){extend(this,{idleTimeout:50,isIdle:!0},t);var e=this,n=function(t){e.onActive(t)};window.addEventListener("pointerdown",n),window.addEventListener("pointerup",n),window.addEventListener("mousedown",n),window.addEventListener("mouseup",n),window.addEventListener("mousemove",n),window.addEventListener("mousewheel",n),window.addEventListener("keydown",n),window.addEventListener("keyup",n),window.addEventListener("touchmove",n),window.addEventListener("touchstart",n)}t.prototype.onActive=function(t){return this.maxIdleTime=(new Date).getTime()+this.idleTimeout,0!=t.button&&null!=t.button||("pointerdown"!=t.type&&"mousedown"!=t.type&&"keydown"!=t.type||(this.keepBusy=!0),"pointerup"!=t.type&&"mouseup"!=t.type&&"keyup"!=t.type||(this.keepBusy=!1)),"mousemove"==t.type&&!this.keepBusy||(this.isIdle?(this.start(t),this.isIdle=!1,this.onBusy&&this.onBusy(t)):(this.maxIdleTime=(new Date).getTime()+this.idleTimeout,this.checkIdle(t)),!0)},t.prototype.start=function(t){return this.maxIdleTime=(new Date).getTime()+this.idleTimeout,null!==this.handler&&clearTimeout(this.handler),this.checkIdle(t),this},t.prototype.stop=function(){return null!==this.handler&&clearTimeout(this.handler),this},t.prototype.checkIdle=function(t){var e;return(new Date).getTime()<this.maxIdleTime?(this.isIdle=!1,e=this,this.onBusy&&this.onBusy(t||{type:"checkIdle",target:this}),null!==this.handler&&clearTimeout(this.handler),void(this.handler=setTimeout((function(){return e.checkIdle(t)}),this.idleTimeout+100))):(this.stop(),this.isIdle=!0,this.onIdle?this.onIdle(t||{type:"checkIdle",target:this}):void 0)},window.Idle=t}()},function(t,e){!function(t){t.Array.Equals=function(t,e){if(!t)return!1;if(!e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if("object"==i(t[n]))error("未对复杂对象进行比较支持！");else if(t[n]!=e[n])return!1};var e=function(t){if(t&&t.length>0){if(Array.isArray(t[0])&&2==t[0].length)return this.data=t,this;error("无效的环数据")}return this.data=[],this};function n(t,e,n,i){var r,o,s;if(r=1,0==t||0==i)return 0==e||0==n?0:e>0?n>0?-r:r:n>0?r:-r;if(0==e||0==n)return i>0?t>0?r:-r:t>0?-r:r;if(0<e?0<i?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):e<=-i?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):0<i?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),0<t){if(!(0<n))return r;if(t>n)return r}else{if(0<n)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(i>e)return r;if(t>(n-=s*t)+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0==i)return 0==n?0:-r;if(0==n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(e>i)return-r;if(n>(t-=s*n)+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0==e)return 0==t?0:r;if(0==t)return-r}}e.prototype.contains=function(t){return e.IsInRing(t,this.data)},e.prototype.toString=function(){return JSON.stringify(this.data)},e.prototype.isCCW=function(){return function(t){var e=null,i=null,r=null,o=null,s=null,a=null,l=!1,u=!1;for(var c in t){var h=t[c],f=r;r=h,u&&!Array.Equals(r,s)&&(u=!1,a=r),l||(l=!0,s=e=h,u=!0),r[1]>s[1]&&(o=f,s=r,u=!0),i=h}if(u)if(Array.Equals(e,s)){for(c=1;c<t.length;c++)if(h=t[c],!Array.Equals(h,s)){a=h;break}}else a=e;if(function(t){return null==t||!!isNaN(t[0])||!!isNaN(t[1])}(o))if(Array.Equals(i,s)){for(c=t.length-2;c>=0;c--)if(!Array.Equals(h,s)){o=h;break}}else o=i;if(Array.Equals(o,s)||Array.Equals(a,s)||Array.Equals(o,a))return!1;var g,d,p,m=(g=o,p=a,n((d=s)[0]-g[0],d[1]-g[1],p[0]-d[0],p[1]-d[1]));return 0==m?o[0]>a[0]:m>0}(this.data)},e.prototype.closeRing=function(){if(this.data&&this.data.length>2){var t=this.data[this.data.length-1];return this.data[0][0]==t[0]&&this.data[0][1]==t[1]||(this.data[this.data.length]=this.data[0]),this}error("环要求数据量大于或等于3")},e.IsInRing=function(t,e){if(null==t)throw new error("点不允许为空");if(null==e)throw new error("环不允许为空");for(var i=0,r=1;r<e.length;r++){var o=r-1,s=e[r],a=e[o];if(s[1]>t[1]&&a[1]<=t[1]||a[1]>t[1]&&s[1]<=t[1]){var l=s[0]-t[0],u=s[1]-t[1],c=a[0]-t[0],h=a[1]-t[1];0<n(l,u,c,h)/(h-u)&&i++}}return i%2==1},t.Ring=e}(window)},function(t,e){!function(t){var e=function(t,e){if(this.data=[],t&&(t.closeRing(),this.data.push(t.data),e))for(var n=0;n<e.length;n++)e[n].closeRing(),this.data.push(e[n].data);return this};e.prototype.contains=function(t){for(var e=0;e<this.data.length;e++)if(0==e){if(!Ring.IsInRing(t,this.data[e]))return!1}else if(Ring.IsInRing(t,this.data[e]))return!1;return!0},e.prototype.toString=function(){return JSON.stringify(this.data)},t.Polygon=e}(window)},function(t,e,n){n(7),function(t){function e(){this.elements=Array(16),this.loadIdentity()}e.prototype={scale:function(t,e,n){return this.elements[0]*=t,this.elements[1]*=t,this.elements[2]*=t,this.elements[3]*=t,this.elements[4]*=e,this.elements[5]*=e,this.elements[6]*=e,this.elements[7]*=e,this.elements[8]*=n,this.elements[9]*=n,this.elements[10]*=n,this.elements[11]*=n,this},translate:function(t,n,r){"object"==i(t)&&(n=t[1]||t.y,r=t[2]||t.z||0,t=t[0]||t.x);var o=new e;return o.M41(t),o.M42(n),o.M43(r),this.multiply(o)},rotate:function(t,n,r,o){"object"==i(n)&&(r=n[1]||n.y,o=n[2]||n.z||0,n=n[0]||n.x);var s,a,l,u,c,h,f,g,d,p,m,y=Math.sqrt(n*n+r*r+o*o),v=Math.sin(t*Math.PI/180),x=Math.cos(t*Math.PI/180);return y>0&&(s=(n/=y)*n,a=(r/=y)*r,l=(o/=y)*o,u=n*r,c=r*o,h=o*n,f=n*v,g=r*v,d=o*v,p=1-x,(m=new e).elements[0]=p*s+x,m.elements[1]=p*u+d,m.elements[2]=p*h-g,m.elements[3]=0,m.elements[4]=p*u-d,m.elements[5]=p*a+x,m.elements[6]=p*c+f,m.elements[7]=0,m.elements[8]=p*h+g,m.elements[9]=p*c-f,m.elements[10]=p*l+x,m.elements[11]=0,m.elements[12]=0,m.elements[13]=0,m.elements[14]=0,m.elements[15]=1,this.multiply(m)),this},lookAtLH:function(t,n,r,o,s,a,l,u,c){var h=null;if("object"==i(t)&&"elements"in t)h=t;else{if("object"==i(r)&&"length"in r){var f=r;l=f[0]||f.x,u=f[1]||f.y,c=f[2]||f.z,o=(f=n)[0]||f.x,s=f[1]||f.y,a=f[2]||f.z,t=(f=t)[0]||f.x,n=f[1]||f.y,r=f[2]||f.z}var g=new Vector3(l,u,c).getNormalize(),d=new Vector3(t,n,r),p=Vector3.Subtract(new Vector3(o,s,a),d).getNormalize(),m=Vector3.Cross(g,p).getNormalize(),y=Vector3.Cross(p,m).getNormalize();h=new e;for(var v=0;v<3;v++)h.setColumn(v,m[v],y[v],p[v],d[v])}d=h.getPosition();var x=h.getRight(),w=(g=h.getUp(),h.getLook()),S=new e;for(v=0;v<3;v++)S.setRow(v,x[v],g[v],w[v],0);return S.setRow(3,-Vector3.Dot(x,d),-Vector3.Dot(g,d),-Vector3.Dot(w,d),1),S=S.multiply(this),this.elements=S.elements,this},frustum:function(t,n,i,r,o,s){var a;return o<=0||s<=0||n-t<=0||r-i<=0||s-o<=0||((a=new e).elements[0]=o/n,a.elements[1]=a.elements[2]=a.elements[3]=0,a.elements[5]=o/r,a.elements[4]=a.elements[6]=a.elements[7]=0,a.elements[8]=0,a.elements[9]=0,a.elements[10]=-(o+s)/(s-o),a.elements[11]=-1,a.elements[14]=-2*o*s/(s-o),a.elements[12]=a.elements[13]=a.elements[15]=0,a=a.multiply(this),this.elements=a.elements),this},perspective:function(t,n,i,r){var o=1/Math.tan(t/360*Math.PI),s=new e;return s.elements[0]=o/n,s.elements[1]=0,s.elements[2]=0,s.elements[3]=0,s.elements[4]=0,s.elements[5]=o,s.elements[6]=0,s.elements[7]=0,s.elements[8]=0,s.elements[9]=0,s.elements[10]=(r+i)/(r-i),s.elements[11]=1,s.elements[12]=0,s.elements[13]=0,s.elements[14]=-2*i*r/(r-i),s.elements[15]=0,s.multiply(this),this.elements=s.elements,this},ortho:function(t,n,i,r,o,s){var a=n-t,l=r-i,u=s-o;if(0==a||0==l||0==u)return this;var c=new e;return c.elements[0]=2/a,c.elements[12]=-(n+t)/a,c.elements[5]=2/l,c.elements[13]=-(r+i)/l,c.elements[10]=-2/u,c.elements[14]=-(o+s)/u,c=c.multiply(this),this.elements=c.elements,this},setUniform:function(t,e,n){t.uniformMatrix4fv(e,n,this.getAsFloat32Array())},multiply:function(t){for(var n=new e,i=0;i<4;i++)n.elements[4*i+0]=this.get(i,0)*t.get(0,0)+this.get(i,1)*t.get(1,0)+this.get(i,2)*t.get(2,0)+this.get(i,3)*t.get(3,0),n.elements[4*i+1]=this.get(i,0)*t.get(0,1)+this.get(i,1)*t.get(1,1)+this.get(i,2)*t.get(2,1)+this.get(i,3)*t.get(3,1),n.elements[4*i+2]=this.get(i,0)*t.get(0,2)+this.get(i,1)*t.get(1,2)+this.get(i,2)*t.get(2,2)+this.get(i,3)*t.get(3,2),n.elements[4*i+3]=this.get(i,0)*t.get(0,3)+this.get(i,1)*t.get(1,3)+this.get(i,2)*t.get(2,3)+this.get(i,3)*t.get(3,3);return this.elements=n.elements,this},copy:function(){for(var t=new e,n=0;n<16;n++)t.elements[n]=this.elements[n];return t},transformCoordinate:function(t){var e=Vector3.Copy(t),n=new Vector3;n[0]=this.M41()+e[0]*this.M11()+e[1]*this.M21()+e[2]*this.M31(),n[1]=this.M42()+e[0]*this.M12()+e[1]*this.M22()+e[2]*this.M32(),n[2]=this.M43()+e[0]*this.M13()+e[1]*this.M23()+e[2]*this.M33();var i=this.M44()+e[0]*this.M14()+e[1]*this.M24()+e[2]*this.M34();return 1!=i&&0!=i&&(n=Vector3.Divide(n,i)),n},get:function(t,e){return this.elements[4*t+e]},getAsFloat32Array:function(){return new Float32Array(this.elements)},invert:function(){var t=this.get(2,2)*this.get(3,3),e=this.get(3,2)*this.get(2,3),n=this.get(1,2)*this.get(3,3),i=this.get(3,2)*this.get(1,3),r=this.get(1,2)*this.get(2,3),o=this.get(2,2)*this.get(1,3),s=this.get(0,2)*this.get(3,3),a=this.get(3,2)*this.get(0,3),l=this.get(0,2)*this.get(2,3),u=this.get(2,2)*this.get(0,3),c=this.get(0,2)*this.get(1,3),h=this.get(1,2)*this.get(0,3),f=this.get(2,0)*this.get(3,1),g=this.get(3,0)*this.get(2,1),d=this.get(1,0)*this.get(3,1),p=this.get(3,0)*this.get(1,1),m=this.get(1,0)*this.get(2,1),y=this.get(2,0)*this.get(1,1),v=this.get(0,0)*this.get(3,1),x=this.get(3,0)*this.get(0,1),w=this.get(0,0)*this.get(2,1),S=this.get(2,0)*this.get(0,1),_=this.get(0,0)*this.get(1,1),b=this.get(1,0)*this.get(0,1),P=t*this.get(1,1)+i*this.get(2,1)+r*this.get(3,1)-(e*this.get(1,1)+n*this.get(2,1)+o*this.get(3,1)),C=e*this.get(0,1)+s*this.get(2,1)+u*this.get(3,1)-(t*this.get(0,1)+a*this.get(2,1)+l*this.get(3,1)),F=n*this.get(0,1)+a*this.get(1,1)+c*this.get(3,1)-(i*this.get(0,1)+s*this.get(1,1)+h*this.get(3,1)),I=o*this.get(0,1)+l*this.get(1,1)+h*this.get(2,1)-(r*this.get(0,1)+u*this.get(1,1)+c*this.get(2,1)),k=1/(this.get(0,0)*P+this.get(1,0)*C+this.get(2,0)*F+this.get(3,0)*I),M=k*P,T=k*C,E=k*F,L=k*I,A=k*(e*this.get(1,0)+n*this.get(2,0)+o*this.get(3,0)-(t*this.get(1,0)+i*this.get(2,0)+r*this.get(3,0))),O=k*(t*this.get(0,0)+a*this.get(2,0)+l*this.get(3,0)-(e*this.get(0,0)+s*this.get(2,0)+u*this.get(3,0))),R=k*(i*this.get(0,0)+s*this.get(1,0)+h*this.get(3,0)-(n*this.get(0,0)+a*this.get(1,0)+c*this.get(3,0))),D=k*(r*this.get(0,0)+u*this.get(1,0)+c*this.get(2,0)-(o*this.get(0,0)+l*this.get(1,0)+h*this.get(2,0))),j=k*(f*this.get(1,3)+p*this.get(2,3)+m*this.get(3,3)-(g*this.get(1,3)+d*this.get(2,3)+y*this.get(3,3))),V=k*(g*this.get(0,3)+v*this.get(2,3)+S*this.get(3,3)-(f*this.get(0,3)+x*this.get(2,3)+w*this.get(3,3))),B=k*(d*this.get(0,3)+x*this.get(1,3)+_*this.get(3,3)-(p*this.get(0,3)+v*this.get(1,3)+b*this.get(3,3))),G=k*(y*this.get(0,3)+w*this.get(1,3)+b*this.get(2,3)-(m*this.get(0,3)+S*this.get(1,3)+_*this.get(2,3))),N=k*(d*this.get(2,2)+y*this.get(3,2)+g*this.get(1,2)-(m*this.get(3,2)+f*this.get(1,2)+p*this.get(2,2))),Z=k*(w*this.get(3,2)+f*this.get(0,2)+x*this.get(2,2)-(v*this.get(2,2)+S*this.get(3,2)+g*this.get(0,2))),z=k*(v*this.get(1,2)+b*this.get(3,2)+p*this.get(0,2)-(_*this.get(3,2)+d*this.get(0,2)+x*this.get(1,2))),H=k*(_*this.get(2,2)+m*this.get(0,2)+S*this.get(1,2)-(w*this.get(1,2)+b*this.get(2,2)+y*this.get(0,2)));return this.elements[0]=M,this.elements[1]=T,this.elements[2]=E,this.elements[3]=L,this.elements[4]=A,this.elements[5]=O,this.elements[6]=R,this.elements[7]=D,this.elements[8]=j,this.elements[9]=V,this.elements[10]=B,this.elements[11]=G,this.elements[12]=N,this.elements[13]=Z,this.elements[14]=z,this.elements[15]=H,this},inverse:function(){return this.copy().invert()},transpose:function(){var t=this.elements[1];return this.elements[1]=this.elements[4],this.elements[4]=t,t=this.elements[2],this.elements[2]=this.elements[8],this.elements[8]=t,t=this.elements[3],this.elements[3]=this.elements[12],this.elements[12]=t,t=this.elements[6],this.elements[6]=this.elements[9],this.elements[9]=t,t=this.elements[7],this.elements[7]=this.elements[13],this.elements[13]=t,t=this.elements[11],this.elements[11]=this.elements[14],this.elements[14]=t,this},loadIdentity:function(){for(var t=0;t<16;t++)this.elements[t]=0;return this.elements[0]=1,this.elements[5]=1,this.elements[10]=1,this.elements[15]=1,this},toString:function(){for(var t="",e=0;e<4;e++){t+="[";for(var n=0;n<4;n++)0!=n&&(t+=","),t+=this.elements[4*e+n];t+="]\n"}return t},getRight:function(){return new Vector3(this.M11(),this.M12(),this.M13())},getUp:function(){return new Vector3(this.M21(),this.M22(),this.M23())},getLook:function(){return new Vector3(this.M31(),this.M32(),this.M33())},getPosition:function(){return new Vector3(this.M41(),this.M42(),this.M43())},setRow:function(t,e,n,i,r){this.elements[4*t+0]=e,this.elements[4*t+1]=n,this.elements[4*t+2]=i,this.elements[4*t+3]=r},setColumn:function(t,e,n,i,r){this.elements[t]=e,this.elements[t+4]=n,this.elements[t+8]=i,this.elements[t+12]=r},GetSetElementsValue:function(t,e){if(null==e||"number"!=typeof e)return this.elements[t];this.elements[t]=e},M11:function(t){return this.GetSetElementsValue(0,t)},M12:function(t){return this.GetSetElementsValue(1,t)},M13:function(t){return this.GetSetElementsValue(2,t)},M14:function(t){return this.GetSetElementsValue(3,t)},M21:function(t){return this.GetSetElementsValue(4,t)},M22:function(t){return this.GetSetElementsValue(5,t)},M23:function(t){return this.GetSetElementsValue(6,t)},M24:function(t){return this.GetSetElementsValue(7,t)},M31:function(t){return this.GetSetElementsValue(8,t)},M32:function(t){return this.GetSetElementsValue(9,t)},M33:function(t){return this.GetSetElementsValue(10,t)},M34:function(t){return this.GetSetElementsValue(11,t)},M41:function(t){return this.GetSetElementsValue(12,t)},M42:function(t){return this.GetSetElementsValue(13,t)},M43:function(t){return this.GetSetElementsValue(14,t)},M44:function(t){return this.GetSetElementsValue(15,t)}},e.Equals=function(t,e){if(null==t||null==e)return!1;for(var n=0;n<t.elements.length;n++)if(t.elements[n]!=e.elements[n])return!1;return!0},t.Matrix=e}(window)},function(t,e){!function(t){var e=function(t,e,n){this.length=3,this.load(t,e,n)};e.prototype={load:function(t,e,n){"object"==i(t)?(this[0]=t[0]||t.x,this[1]=t[1]||t.y,this[2]=t[2]||t.z||0):"number"==typeof t?(this[0]=t,this[1]=e,this[2]=n):(this[0]=0,this[1]=0,this[2]=0)},getAsArray:function(){return[this[0],this[1],this[2]]},getAsFloat32Array:function(){return new Float32Array(this.getAsArray())},vectorLength:function(){return Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2])},toString:function(){return"["+this[0]+","+this[1]+","+this[2]+"]"},getNormalize:function(){return e.Normalize(this)},copy:function(){return e.Copy(this)}},e.Copy=function(t){var n=new e;return n[0]=t[0]||t.x||0,n[1]=t[1]||t.y||0,n[2]=t[2]||t.z||0,n},e.TransformCoordinate=function(t,e){return e.transformCoordinate(t)},e.TransformNormal=function(t,e){return e.transformCoordinate(t.getNormalize())},e.Add=function(t,n){var i=new e;return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]||0+n[2]||0,i},e.Subtract=function(t,n){var i=new e;return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]||0-n[2]||0,i},e.Cross=function(t,n){var i=new e;return i[0]=t[1]*n[2]-t[2]*n[1],i[1]=t[2]*n[0]-t[0]*n[2],i[2]=t[0]*n[1]-t[1]*n[0],i},e.Dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},e.Divide=function(t,n){var i=new e(t);return i[0]/=n,i[1]/=n,i[2]/=n,i},e.Multiply=function(t,n){var i=new e(t);return i[0]*=n,i[1]*=n,i[2]*=n,i},e.Normalize=function(t){var n=t.vectorLength();return 0!=n?e.Divide(t,n):new e(t)},e.Unproject=function(t,n,i){var r=new e,o=i.inverse();return r[0]=(t[0]-n.X)/n.Width*2-1,r[1]=-((t[1]-n.Y)/n.Height*2-1),r[2]=(t[2]-n.MinZ)/(n.MaxZ-n.MinZ),e.TransformCoordinate(r,o)},e.Projection=function(t,n,i){var r=e.TransformCoordinate(t,i);return new e(.5*(1+r[0])*n.Width+n.X,.5*(1-r[1])*n.Height+n.Y,r[2]*(n.MaxZ-n.MinZ)+n.MinZ)},e.CalcVectorAngle=function(t,n){var i=e.Dot(t,n)/(t.vectorLength()*n.vectorLength());return i<-1&&(i=-1),i>1&&(i=1),Math.acos(i)},t.Vector3=e}(window)},function(t,e,n){n(2),n(3),n(0),n(11),n(12),n(13),n(14),n(15),n(16),n(17)},function(t,e){var n={PI:3.141592653589793,x_pi:52.35987755982988,delta:function(t,e){var n=6378245,i=.006693421622965943,r=this.transformLat(e-105,t-35),o=this.transformLon(e-105,t-35),s=t/180*this.PI,a=Math.sin(s);a=1-i*a*a;var l=Math.sqrt(a);return{lat:r=180*r/(n*(1-i)/(a*l)*this.PI),lon:o=180*o/(n/l*Math.cos(s)*this.PI)}},gcj_encrypt:function(t){var e=this.delta(t[1],t[0]);return[t[0]+e.lon,t[1]+e.lat]},gcj_decrypt:function(t){var e=this.delta(t[1],t[0]);return[t[0]-e.lon,t[1]-e.lat]},transformLat:function(t,e){var n=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,(n+=2*(20*Math.sin(e*this.PI)+40*Math.sin(e/3*this.PI))/3)+2*(160*Math.sin(e/12*this.PI)+320*Math.sin(e*this.PI/30))/3},transformLon:function(t,e){var n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,(n+=2*(20*Math.sin(t*this.PI)+40*Math.sin(t/3*this.PI))/3)+2*(150*Math.sin(t/12*this.PI)+300*Math.sin(t/30*this.PI))/3}};window.GPS=n},function(t,e){var n,i;n=window,i={askLabelSpace:function(t,e,n,r,o,s,a){var l,u=-1;o=o||20;var c=a||20;if(s)for(var h=0;h<8;h++){l=i._getLabelBound(t,h,e,n,o);for(var f=!1,g=0,d=r.length;g<d;++g){var p=r[g].bounds,m=[p[0]-c,p[1]-c,p[2]+c,p[3]+c];if(ol.extent.intersects(l,m)){f=!0;break}}if(!f){u=h;break}}else u=0,l=i._getLabelBound(t,u,e,n,o);if(u>-1){var y=ol.extent.getTopRight(l),v=ol.extent.getBottomLeft(l);return{center:t,x:i._getLabelAnchor(t,u,e,n,o),l:v,r:y,bounds:l,position:u}}return null},_getLabelBound:function(t,e,n,i,r){var o,s,a,l,u=t[0],c=t[1];switch(e){case 0:s=(o=u+r)+n,l=(a=c-r)-i;break;case 1:s=(o=u+r)+n,l=(a=c+i/2)-i;break;case 2:s=(o=u+r)+n,l=(a=c+r+i)-i;break;case 3:s=(o=u-n/2)+n,l=(a=c+r+i)-i;break;case 4:o=(s=u)-n,l=(a=c+r+i)-i;break;case 5:o=(s=u-r)-n,l=(a=c+i/2)-i;break;case 6:o=(s=u)-n,l=(a=c-r)-i;break;case 7:s=(o=u-n/2)+n,l=(a=c-r)-i}return[o>s?s:o,l>a?a:l,o>s?o:s,(l>a?l:a)+1]},_getLabelAnchor:function(t,e,n,i,r){var o=[0,0];switch(r=r||20,n=n||70,i=i||20,e){case 0:o[0]=t[0]+r,o[1]=t[1]-r-i/2;break;case 1:o[0]=t[0]+r,o[1]=t[1];break;case 2:o[0]=t[0]+r,o[1]=t[1]+r+i/2;break;case 3:o[0]=t[0],o[1]=t[1]+r+i/4;break;case 4:o[0]=Math.max(t[0]-r,t[0]-n/2),o[1]=t[1]+r+i/4;break;case 5:o[0]=t[0]-r,o[1]=t[1];break;case 6:o[0]=Math.max(t[0]-r,t[0]-n/2),o[1]=t[1]-r-i/4;break;case 7:o[0]=t[0],o[1]=t[1]-r-i/4}return o}},n.ShipUtils=i},function(t,e,n){var i,r,o,s;n(0),i=ol.control.Control,o={clickFn:function(){console.log("未设置点击事件")}},s=function(t){r=extend(o,t);var e=document.createElement("button");e.innerHTML=r.innerHTML||"";var n=document.createElement("div");n.className=r.className+" ol-unselectable ol-control"||!1,n.appendChild(e),n.title=r.title||"",i.call(this,{element:n,target:r.target}),r.clickFn&&e.addEventListener("click",r.clickFn,!1)},i&&(s.__proto__=i),s.prototype=Object.create(i&&i.prototype),window.ships.controls.base=s},function(t,e,n){n(0),function(t){function e(n){var i=extend({zIndex:10,toFixedNum:4,startDrawTip:"点击开始绘制",continueTip:"点击继续测距",maxLength:1e3},n);this._map=i.map,delete i.map;var r=t.call(this,i)||this,o=new ol.source.Vector;this.setSource(o);var s,a,l,u,c,h=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})}),text:new ol.style.Text({rotateWithView:!1,backgroundFill:new ol.style.Fill({color:"yellow"}),placement:"line",font:"12px sans-serif",fill:new ol.style.Fill({color:"#f08318"}),textAlign:"right",textBaseline:"ideographic",padding:[10,10,10,12]})}),f=new ol.layer.Vector({source:o,style:h,zIndex:i.zIndex}),g=i.continueTip;return map.on("pointermove",(function(t){if(!t.dragging){var e=i.startDrawTip;s&&s.getGeometry()instanceof ol.geom.LineString&&(e=g),a.innerHTML=e,l.setPosition(t.coordinate),a.classList.remove("hidden")}})),map.getViewport().addEventListener("mouseout",(function(){a.classList.add("hidden")})),function(){var t;c=new ol.interaction.Draw({source:o,type:"LineString",style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ol.style.Circle({src:""})}),zIndex:i.zIndex}),map.addInteraction(c),a&&a.parentNode.removeChild(a),(a=document.createElement("div")).className="ol-tooltip hidden",l=new ol.Overlay({element:a,offset:[15,0],positioning:"center-left"}),map.addOverlay(l);var e,n=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ol.style.Circle({src:""}),text:new ol.style.Text({rotateWithView:!1,backgroundFill:new ol.style.Fill({color:"yellow"}),placement:"line",font:"12px sans-serif",fill:new ol.style.Fill({color:"#f08318"}),textAlign:"right",textBaseline:"ideographic",padding:[10,10,10,12]})});c.on("drawstart",(function(r){s=r.feature,r.coordinate,t=s.getGeometry().on("change",(function(t){var r,o,a=t.target;a instanceof ol.geom.LineString&&(r=a,o=ol.sphere.getLength(r),e=o>i.maxLength?(Math.round(100*o)/100/1852).toFixed(i.toFixedNum)+" nm":(Math.round(100*o)/100).toFixed(i.toFixedNum)+" m",a.getLastCoordinate(),s.setStyle(n),s.getStyle().getText().setText(e))}))})),c.on("drawend",(function(){map.removeInteraction(c),map.removeOverlay(u),s.setStyle(h),s.getStyle().getText().setText(e),ol.Observable.unByKey(t)}))}(),map.addLayer(f),e.prototype.close=function(){map.removeInteraction(c),map.removeLayer(f),map.removeOverlay(u),map.getOverlays().clear(),map.removeOverlay(l)},r}window.ships.extends(e,t),window.ships.layers.MeasureLayer=e}(ol.layer.Vector)},function(t,e){!function(t){function e(e){var n=extend({zIndex:10},{name:"定位图层",zIndex:10,iconSrc:"images/ship.png",fitPadding:[100,150,150,100],duration:1e3,maxZoom:10,scale:.12,fitZoom:10,codingCoordinate:!0,coordinate:null},e);this._map=n.map,delete n.map;var i=t.call(this,n)||this,r=new ol.style.Style({image:new ol.style.Icon({src:this.get("iconSrc"),scale:this.get("scale"),anchor:[.5,.96]})}),o=new ol.source.Vector({features:[]});return this.setSource(o),this.locationByCoordinate=function(t){var e;i.coordinate=t,(e=new ol.Feature(new ol.geom.Point(ships.fromLonLat(ships.encodeCoordinate(t,ships.geometrys.china))))).setStyle(r);var n=this.getSource().getFeatures()[0];n&&this.getSource().removeFeature(n),this.getSource().addFeature(e),this.changeCoding(ships.codingCoordinate);var o=e.getGeometry().getExtent();ships.flyTo(this._map,o,{padding:this.get("fitPadding"),duration:this.get("duration"),maxZoom:this.get("fitZoom")})},this.changeCoding=function(t){var e;this.codingCoordinate!=t&&(this.codingCoordinate=t,e=t?ships.fromLonLat(ships.encodeCoordinate(i.coordinate,ships.geometrys.china)):ships.fromLonLat(ships.decodeCoordinate(i.coordinate,ships.geometrys.china)),this.getSource().getFeatures()[0].getGeometry().setCoordinates(e))},i}window.ships.extends(e,t),window.ships.layers.LocationLayer=e}(ol.layer.Vector)},function(t,e,n){n(4),n(5),n(6),n(1),function(t){var e=t.layers.RenderLayer;function n(n){this.historySource=new ol.source.Vector({features:[]});var i={};this._hitHandle=function(){var t=[8,8],e=this.getZoom();if(e>13){var n=e-13,i=8*Math.pow(2,n);t=[i,i]}return t},this.setting=merge({},{url:"/ais/getExtent",asyncProcessData:!1,asyncProcessDataMinCount:1e3,updateWhenIdle:15,keymap:{id:"mmsi",name:"name",cen:"center",spd:"speed",hdg:"hdg",cog:"cog",shipType:"shipType",type:"shipType",sailStatus:"sailStatus",status:"sailStatus",len:"length",wid:"breadth",time:"createdAt",from:"from",a:"a",b:"b",c:"c",d:"d",geom:"geom"},shipsimple:{path_rings:[[0,-8],[5,8],[-5,8]],center:[0,0],bounds:[-12,-12,12,12]},shipcomplex:{path_rings:[[0,-5],[2.8,-4.3],[5,-3],[5,4],[4,5],[-4,5],[-5,4],[-5,-3],[-2.8,-4.3]],center:[0,0],bounds:[-5,-5,5,5],scale:1.06},speedCondition:{0:[1,10],1:[10,20],2:[20]},leftPath:{0:[[0,0],[0,-8],[-4,-8]],1:[[0,0],[0,-16],[-6,-16]],2:[[0,0],[0,-24],[-8,-24]]},rightPath:{0:[[0,0],[0,-8],[4,-8]],1:[[0,0],[0,-16],[6,-16]],2:[[0,0],[0,-24],[8,-24]]},frontPath:{0:[[0,0],[0,-8]],1:[[0,0],[0,-16]],2:[[0,0],[0,-24]]},pointMinZoom:10,pointMaxZoom:10,pointRadius:3,maxShipLength:400,shipControl:{14:[200,30],15:[115,15],16:[55,8],17:[25,5],18:[15,2]},shipCondition:{},shipDictionary:{from:{type:"subStringEqual",startIndex:0,length:1,index:["S","D","B","O"]},sailStatus:{type:"equal",index:["停止","航行","作业","危险","其他"],"停止":["1","5"],"航行":["0","2","3","8"],"作业":["7","11","12"],"危险":["4","6"],"其他":["","9","10","13","14","15"]},length:{type:"between",index:["0-40","41-80","81-120","121-160","161-240","241-320","大于320"],"0-40":[0,40],"41-80":[40,80],"81-120":[80,120],"121-160":[120,160],"161-240":[160,240],"241-320":[240,320],"大于320":[320]},shipType:{type:"equal",index:["7","-10","8","5","3","6","-5","其他"],7:["70","71","72","73","74","75","76","77","78","79"],"-10":["100"],8:["80","81","82","83","84","85","86","87","88","89"],5:["31","32","33","34","35","50","51","52","53","54","58","59"],3:["30"],6:["60","61","62","63","64","65","66","67","68","69","37"],"-5":["55"],"其他":["90","99",""]},type:{type:"equal",my:!0},salText:"S"},maxKeepTime:144e5,viewOutSize:18520,history:{visible:!0,maxCount:30,strokeStyle:"#999999",lineDash:[],selected:"red",repair:!0,zoom:13},cacheCount:-1,checkDistance:!0,maxDistance:25,distance:null,cluster:!1,track:{withoutStates:[1,5],timespan:3e5,count:10,maxTime:18e5,src:"images/shiptrack.png",zoom:15,visible:!1,delay:15.433332},renderOrder:function(t,e){var n=t.order-e.order;if(t.data&&e.data){var i=e.data.length-t.data.length||0;return 0==n?0==i?e.data.breadth-t.data.breadth==0?e.data.mmsi>t.data.mmsi:e.data.breadth-t.data.breadth:i:n}return n}},n);var r=e.call(this,this.setting)||this;this.setting.track&&this.setting.track.visible&&(this.trackImage=new Image,this.trackImage.onload=function(t){r.trackImage.state="ready"},this.trackImage.src=this.setting.track.src);var o=new ol.style.Style({renderer:function(t,e){for(var n=0;n<r.renderAreas.length;n++)r.renderShip(t,e,r.renderAreas[n])}}),s=new ol.style.Style({renderer:function(t,e){r.renderLine(t,e)}}),a=new ol.style.Style({renderer:function(t,e){r.renderLine(t,e,!0)}}),l=new ol.style.Style({stroke:new ol.style.Stroke({color:"blue",width:2})}),u=new ol.style.Style({fill:new ol.style.Fill({color:"red",width:2})}),c=new ol.style.Style({stroke:new ol.style.Stroke({color:r.setting.history.strokeStyle,width:r.setting.weight})}),h=new ol.style.Style({stroke:new ol.style.Stroke({color:r.setting.history.selected,width:r.setting.weight})});if(this.renderLine=function(t,e,n){if(this._map){this._pixelRatio&&this._pixelRatio==e.pixelRatio||(this._pixelRatio=e.pixelRatio);var i=e.feature.getId().replace("line_",""),o=this.getSource().getFeatureById(i);if(o&&0!=o.data.visible&&(!this._checkSelf(this._map.selectedFeature,o)&&this.getZoom()>this.get("pointMaxZoom")&&("my"==o.data.type||this.getZoom()>=this.setting.history.zoom)&&this.checkShipCondition(o.data)||n)){this._ctx.save();var s=this.setting.history.lineDash,a=t;if(this._pixelRatio){a=[];for(var l=0;l<e.feature.getGeometry().getCoordinates().length;l++)a.push(this._map.getPixelFromCoordinate(e.feature.getGeometry().getCoordinates()[l]))}if(s)this._ctx.setLineDash(s),this.drawPloyline(a,n?r.setting.history.selected:r.setting.history.strokeStyle);else for(l=1;l<a.length;l++)s=[a.length-l+1,2],this._ctx.setLineDash(s),this.drawPloyline([a[l-1],a[l]],n?r.setting.history.selected:r.setting.history.strokeStyle);this._ctx.restore()}}},params.debug){var f=this.getSource().getFeatureById("chinabounds");if(null==f&&t.datas.chinabounds){var g=[];for(var d in t.datas.chinabounds){var p=t.fromLonLats(t.datas.chinabounds[d]);g.push(p)}(f=new ol.Feature(new ol.geom.MultiLineString(g))).setId("chinabounds"),f.setStyle(l),this.source.addFeature(f)}}var m=new ol.style.Style;this.beforeRender=function(t){this._map.labels=[]},this.onPostRender=function(t){var e=this._map.getView().getZoom();this._map.selectedFeature&&this._map.selectedLayer==this.ol_uid&&this.renderSelected(this._map.selectedFeature,!0,!0),this._map.lastOn&&this._map.lastOnLayer==this.ol_uid&&this.get("shipCondition")&&this.checkShipCondition(this._map.lastOn.data)&&(this._checkSelf(this._map.selectedFeature,this._map.lastOn)||this.renderSelected(this._map.lastOn,!1,!0));for(var n=this.getVisible()&&this.setting.showLabel&&(null==this.setting.labelMinZoom||e>=this.setting.labelMinZoom)&&(null==this.setting.labelMaxZoom||e<=this.setting.labelMaxZoom),i=this.getSource().getFeaturesInExtent(this.currentExtent),o=0;o<i.length;o++){var s=i[o];if((n||s.data&&"my"==s.data.type)&&s.point&&s.seq==this.renderSeq&&!this._checkSelf(this._map.selectedFeature,s)&&!this._checkSelf(this._map.lastOn,s)&&s.getId()&&s.getId().indexOf("line_")<0&&s.data&&0!=s.data.visible){if(null==s.data.centerPoint||2!=s.data.centerPoint.length){debug().log("不合法的坐标数据",s.data);continue}if(this.get("shipCondition")&&!this.checkShipCondition(s.data))continue;var a=this.setting.stroke?s.data.stroke||"black":null,l="my"==s.data.type&&s.data.fill||(s.data&&"S"==s.data.fromResult?"black":null),u=this.drawLabel(s.point,s.data.name,a,this.setting.textStyle,this.setting.textBackStyle,l);if(s.data&&"S"==s.data.fromResult&&u){var c=this.get("labelHeight")/2+this.get("labelOutSize");this.drawSatellite([u.l[0]+c,u.l[1]+c],6,r.get("salText"),"red","#fff","12px iconfont")}}}t.renderCount=this.renderingCount,this.renderCount=this.renderingCount,this._renderCountChangedHandle(t)},this.renderSelected=function(t,e,n){var i=this.setting.stroke?t.data.stroke||"black":null;if(this.setting.selectedStyle&&(i=this.setting.selectedStyle),this._pixelRatio&&this.renderSeq!=t.seq&&(t.point=this._map.getPixelFromCoordinate(t.data.centerPoint)),this.drawShipBody(t.data,t.point,i),e&&this.drawSelectedBounds(t.pxBounds,i,t.point),n){i=this.setting.stroke?t.data.stroke||"black":null;var o="my"==t.data.type&&t.data.fill||(t.data&&"S"==t.data.fromResult?"black":null),s=this.drawLabel(t.point,t.data.name,i,this.setting.textStyle,this.setting.textBackStyle,o);if(t.data&&"S"==t.data.fromResult&&s){var a=this.get("labelHeight")/2+this.get("labelOutSize");this.drawSatellite([s.l[0]+a,s.l[1]+a-.5],6,r.get("salText"),"red","#fff","12px iconfont")}}},this.distachOffset=function(t){var e=[0,0];return t&&(t.a&&t.b&&(e[1]=(t.a-t.b)/2),t.c&&t.d&&(e[0]=(t.c-t.d)/2)),e},this.renderShip=function(e,n,i){if(this._map){this._pixelRatio&&this._pixelRatio==n.pixelRatio||(this._pixelRatio=n.pixelRatio);var r=this.getZoom(),o=n.feature;if(this._pixelRatio){o.data.offset=this.distachOffset(o.data),o.data.centerPoint=new t.fromLonLat(t.encodeCoordinate(o.data.center,t.geometrys.china));var s=this._map.getPixelFromCoordinate(o.data.centerPoint);if(0!=i&&(s[0]=s[0]+i),!(s[0]>=0&&s[0]<=this._map.getView().getViewportSize_()[0]&&s[1]>=0&&s[1]<=this._map.getView().getViewportSize_()[1]))return;o.point=s,o.seq=this.renderSeq}if(!this.get("shipCondition")||this._checkSelf(this._map.selectedFeature,o)||this.checkShipCondition(o.data)){var a=this.setting.shipControl[Math.floor(r)];if(this.checkShip(o.data,a)){var l=o.data.breadth/10*this.setting.shipcomplex.scale,u=o.data.length/10*this.setting.shipcomplex.scale;if(!o.data.path_rings_complex){o.data.path_rings_complex=[];for(var c=0;c<this.setting.shipcomplex.path_rings.length;c++)o.data.path_rings_complex[c]=[this.setting.shipcomplex.path_rings[c][0]*l-o.data.offset[0],this.setting.shipcomplex.path_rings[c][1]*u-o.data.offset[1]]}o.data.path_rings=[],o.data.drawType="complex";var h=1/this._map.getView().getResolution();for(c=0;c<o.data.path_rings_complex.length;c++)o.data.path_rings[c]=[o.data.path_rings_complex[c][0]*h,o.data.path_rings_complex[c][1]*h];o.pxBounds=[(this.setting.shipcomplex.bounds[0]*l-o.data.offset[0])*h-2,(this.setting.shipcomplex.bounds[1]*u-o.data.offset[1])*h-2,(this.setting.shipcomplex.bounds[2]*l-o.data.offset[0])*h+2,(this.setting.shipcomplex.bounds[3]*u-o.data.offset[1])*h+2];var f=v(o,o.data.angle);f&&(o.pxBounds=f),o.data.speed_path=null}else o.data.path_rings!=this.setting.shipsimple.path_rings&&(o.data.drawType="simple",o.data.path_rings=this.setting.shipsimple.path_rings,o.pxBounds=this.setting.shipsimple.bounds,o.data.speed_path=null);if(!1!==o.data.visible){var g=this._checkSelf(this._map.selectedFeature,o)||this._checkSelf(this._map.lastOn,o);if("my"!=o.data.type&&(new Date).getTime()-o.data.createdAt>this.setting.maxKeepTime&&!g){var d=this.getSource().getFeatureById("line_"+o.data.mmsi);return d&&this.getSource().removeFeature(d),void(this.getSource().getFeatureById(o.data.mmsi)&&this.getSource().removeFeature(o))}if(ol.extent.containsCoordinate(this.currentExtent,o.data.centerPoint)&&this.renderingCount++,!g&&(o.seq=this.renderSeq,null==this.setting.pointMinZoom||r>=this.setting.pointMinZoom||"my"==o.data.type))if((null==this.setting.pointMaxZoom||r<=this.setting.pointMaxZoom)&&"my"!=o.data.type)this.drawPoint(o.point,this.setting.pointRadius,this.setting.fillStyle);else if(o.data&&o.data.fill){var p=this.setting.stroke?o.data.stroke||"black":null;this.drawShipBody(o.data,o.point,p)}}}}},setInterval((function(t){r._updateData(t)}),1e3*this.get("updateWhenIdle")),this._updateData=function(t){if(this._map){if(this.getVisible()){var e=this.get("lasttime"),n={map:this._map,lasttime:e},i=(new Date).getTime()-e;null==e||i>=1e3*this.get("updateWhenIdle")||this.source.getFeatures().length>1e4?this.manageData():debug().warn("上次更新时间间隔不足，放弃本次清理",e,i)}if(this.checkZoom(n)&&!this._map.getView().getInteracting()){var r=this.getMapExtent(n);this.callData(n,r)}else debug().warn("界面正在交互，放弃本次更新")}},this.manageData=function(){var t=this.get("cacheCount"),e=this.source.getFeatures().length;if(-1==t||t<e){var n=this.getMapExtent_(),i=this.source.getFeaturesInExtent(n);if(!this._map.getView().getInteracting()&&i.length<e-100)for(var r=(new Date).getTime(),o=i.length-1;o>=0;o--){var s=i[o];null!=s.data&&"my"!=s.data.type&&r-s.data.createdAt>this.setting.maxKeepTime&&s.getId()&&s.getId().indexOf("line_")<0&&!this._checkSelf(this._map.selectedFeature,s)&&i.splice(o,1)}this.source.clear(),this.source.addFeatures(i),this._map.selectedFeature&&this._map.selectedLayer===this.ol_uid&&null==this.source.getFeatureById(this._map.selectedFeature.getId())&&this.source.addFeature(this._map.selectedFeature)}this.clearOutsizeLine()},this.checkShip=function(t,e){return e&&t.length>=e[0]&&t.breadth>=e[1]&&t.length<this.setting.maxShipLength&&t.length>2*t.breadth&&t.length<10*t.breadth},this.removeShipFromMyTeam=function(t,e){this._changeShip(t,e,"remove")},this.addShipToMyTeam=function(t,e){this._changeShip(t,e,"add")},this._changeShip=function(t,e,n){var i=this.source.getFeatureById(t);if("remove"==n){i.data.type="other",i.order=0;var r=this.source.getFeatureById("line_"+t);r&&this.source.removeFeature(r)}else i.data.type="my",i.order=99;var o=i.data.visible!==e.visible;extend(i.data,e);var s=extend({selected:!0,flyTo:!1},e),a=this.processData(i.data,!0);a&&(o&&this._setShipVisible(a),this.source.addFeature(a),!1===s.selected||this._checkSelf(this._map.selectedFeature,a)||(this._map.selectedFeature=a,s.flyTo&&a.getGeometry()&&this._map.getView().fit(a.getGeometry(),{duration:s.duration||this.setting.duration})))},this.clearAndReload=function(){this.reloadData=!0,this.source.clear()},this.reset=function(t){if(this.getVisible()&&this.checkZoom(t)&&(this._map||(this._map=t.map),this.getZoom()>this.get("pointMaxZoom"))){var e=this.getMapExtent(t,!0);this.callData(t,e)}},this.callData=function(t,e){if(null!=e){var n=extend({},t);n.type="getData",n.extent=e,n.target=this,n.zoom=this.getZoom(),this.dispatchEvent(n)}},this.processData=function(e,n){if(e.mmsi&&e.center){if(e.centerPoint&&!n)return shipLayer.getSource().getFeatureById(e.mmsi);if(!n){var i=this.source.getFeatureById(e.mmsi);if(i&&i.data&&"my"==i.data.type&&"my"!=e.type)return}if(null==e.type&&(e.type="other"),(e.hdg||e.cog)&&(e.angle=t.getShipAngle(e)),"my"!=e.type){if(e.createdAt){var r=((new Date).getTime()-1*e.createdAt)/36e5;e.fill=r<=.5?"#00cc00":r>.5&&r<=4?"#b3f0b3":"#ccc"}}else(null==e.length||0==e.length)&&e.a&&e.b&&(e.length=1*e.a+1*e.b),(null==e.breadth||0==e.breadth)&&e.c&&e.d&&(e.breadth=1*e.c+1*e.d);if(e.direction=t.judgeShipDirect(e.speed,e.hdg,e.cog),e.direction)for(var o in this.setting.speedCondition){var s=this.setting.speedCondition[o];if(isArray(s)&&(e.speed>=s[0]||null==s[0])&&(e.speed<s[1]||null==s[1])){e.speedRings=this.setting[e.direction+"Path"][o];break}}var a=this.get("shipDictionary");for(var l in a){var u=a[l].index;if(null!=u)for(var c in u){s=u[c];var h=a[l].type,f=e[l];if("subStringEqual"==h&&f){if(s==(f=e[l].substring(a[l].startIndex,a[l].length))){e[l+"Result"]=s;break}}else if("equal"==h){if(0==(g=a[l][s]).length){e[l+"Result"]=s;break}if(g.indexOf(e[l])>=0||g.indexOf("")>=0){e[l+"Result"]=s;break}}else if("between"==h){var g;if((null==(g=a[l][s])[0]||1*e[l]>g[0])&&(null==g[1]||1*e[l]<=g[1])){e[l+"Result"]=s;break}}}}return this._project(e)}},this.changeCoding=function(e){if(this.codingCoordinate!=e){for(var n=this.source.getFeatures(),i=0;i<n.length;i++){var r=this.source.getFeatureById("line_"+n[i].getId());if(r){for(var o=[],s=0;s<r.getGeometry().getCoordinates().length;s++){t.codingCoordinate=!e;var a=t.decodeCoordinate(t.toLonLat(r.getGeometry().getCoordinates()[s]),t.geometrys.china);t.codingCoordinate=e,o.push(t.fromLonLat(t.encodeCoordinate(a,t.geometrys.china)))}r.getGeometry().setCoordinates(o)}if(n[i].data&&n[i].data.center){var l=this._project(n[i].data);l&&(n[i]=l)}}this.codingCoordinate=e}},this._project=function(e){e.centerPoint=t.fromLonLat(t.encodeCoordinate(e.center,t.geometrys.china));var n=this.source.getFeatureById(e.mmsi),l=0;if(n&&n.data&&e&&(l=e.createdAt-n.data.createdAt),this.get("checkDistance")&&!this.changing&&n&&Vector3.Subtract(e.centerPoint,n.data.centerPoint).vectorLength()/l*1e3>this.get("maxDistance"))return n;if(isNaN(e.centerPoint[0])||isNaN(e.centerPoint[1]))throw new error("数据存在无效的经纬度",e.center);var u=this.source.getFeatureById(e.mmsi);if(this.getHistory()){var f=this._historyData&&this._historyData[e.mmsi],g=this.source.getFeatureById("line_"+e.mmsi);if("my"==e.type&&f&&f.length>2){var d=[];if(f){this.setting.history.repair&&f.length>0&&(f[0][0]!=e.lon||f[0][1]!=e.lat)&&d.push(e.centerPoint);for(var p=0;p<f.length&&p<this.setting.history.maxCount;p++)d.push(new t.fromLonLat(t.encodeCoordinate([1*f[p].lon,1*f[p].lat],t.geometrys.china)))}g?g.setGeometry(new ol.geom.LineString(d)):((y=new ol.Feature(new ol.geom.LineString(d))).setId("line_"+e.mmsi),!1===e.historyVisible||!1===e.visible?y.setStyle(m):y.setStyle((function(t){var e=t.getId().replace("line_","");return r._checkSelfId(r._map.lastOn,e)||r._checkSelfId(r._map.selectedFeature,e)?h:c})),y.data={type:"my",createdAt:e.createdAt},y.order=-1,this.source.addFeature(y),i[e.mmsi]="my")}else{var y;if(g)if(this.setting.track.zoom<=this.getZoom()&&this.setting.track.count>2&&this.setting.track.timespan>=l&&this.setting.track.withoutStates.indexOf(e.sailStatus)<0&&!this.changing){var v=e.createdAt-this.setting.track.time,x=this.setting.track.count;if(g.data.times)for(p=0;p<g.data.times.length&&p<this.setting.track.count;p++)if(g.data.times[p]<v){x>p&&(x=[p]);break}g.getGeometry().getCoordinates().length>=x&&(g.data&&g.data.times&&g.data.times.splice(x,g.data.times.length-x),g.getGeometry().getFlatCoordinates().splice(2*x,g.getGeometry().getFlatCoordinates().length-2*x)),g.getGeometry().getCoordinates()[0][0]==e.centerPoint[0]&&g.getGeometry().getCoordinates()[0][1]==e.centerPoint[1]||(g.getGeometry().getCoordinates().length==this.setting.track.count&&(g.getGeometry().getFlatCoordinates().pop(),g.getGeometry().getFlatCoordinates().pop()),g.getGeometry().getFlatCoordinates().splice(0,0,e.centerPoint[0],e.centerPoint[1]),g.data.createdAt=e.createdAt,g.data&&g.data.times&&g.data.times.splice(0,0,e.createdAt),g.getGeometry().changed())}else this.source.removeFeature(g);else this.setting.track.zoom<=this.getZoom()&&this.setting.track.count>2&&this.setting.track.timespan>=l&&this.setting.track.withoutStates.indexOf(e.sailStatus)<0&&!this.changing&&((y=new ol.Feature(new ol.geom.LineString([e.centerPoint]))).setId("line_"+e.mmsi),!1===e.historyVisible||!1===e.visible?y.setStyle(m):y.setStyle((function(t){var e=t.getId().replace("line_","");return r._checkSelfId(r._map.lastOn,e)||r._checkSelfId(r._map.selectedFeature,e)?a:s})),y.data={type:"",createdAt:e.createdAt,times:[e.createdAt]},y.order=-2,this.source.addFeature(y),i[e.mmsi]="")}}return null==u?((u=new ol.Feature(new ol.geom.Point(e.centerPoint))).setId(e.mmsi),u.data=e,u.setStyle(o)):(u.data=e,e.centerPoint[0]==u.getGeometry().flatCoordinates[0]&&e.centerPoint[1]==u.getGeometry().flatCoordinates[1]||u.setGeometry(new ol.geom.Point(e.centerPoint))),u.order="my"==e.type?99:0,u},this.populate=function(t,e,n,i){if(t&&t.data&&(this.set("lasttime",t.time),t.data.length>0&&this.processDataHandler(t,e,i)),n){var r=[];n.history&&n.history.data?this._historyData=n.history.data:this._historyData=[];for(var o=0;o<n.data.length;o++){var s=n.data[o];s.center=[1*s.lon,1*s.lat],s.createdAt=1*s.createdAt;var a=this.processData(s);a&&r.push(a)}this.source.addFeatures(r)}},this.processDataHandler=function(t,e,n){var i=(new Date).getTime();debug().time("数据处理"+i);var o=t.data,s=[];t.map&&(this.get("asyncProcessData")&&o.length>this.get("asyncProcessDataMinCount")?setTimeout((function(){r.processDataHandler_(i,e,n,t.map,o,s,100)}),0):this.processDataHandler_(i,e,n,t.map,o,s))},this.clearOutsizeLine=function(){(new debug).info("正在清除范围外的线");var t=this.getMapExtent_();for(var e in i){var n,r=this.getSource().getFeatureById(e);r&&r.data?"my"!=i[e]&&("delete"==i[e]||this.getZoom()<this.get("pointMinZoom")||!ol.extent.containsCoordinate(t,r.data.centerPoint))&&((n=this.getSource().getFeatureById("line_"+e))&&this.getSource().removeFeature(n),delete i[e]):(n=this.getSource().getFeatureById("line_"+e))&&this.getSource().removeFeature(n)}},this.getHistory=function(){return this.get("history").visible},this.setHistory=function(t){for(var e in this.get("history").visible=t,this._historyData)this.setShipVisible(e,null,t);this.changed()},this.setShipVisible=function(t,e){var n=this.findById(t);n&&n.data&&(null!=e&&(n.data.visible=e),this._setShipVisible(n))},this._setShipVisible=function(t){var e=this.findById("line_"+t.getId());e&&(this.getHistory()&&t.data.visible?e.setStyle(s):e.setStyle(m))},this.drawDebugBounds=function(t){if(params.debug){var e=this.source.getFeatureById("shell");null==e?((e=new ol.Feature(t)).setId("shell"),e.setStyle(u),this.source.addFeature(e)):e.setGeometry(t)}},this.processDataHandler_=function(t,e,n,i,o,s,a){for(var l=a||o.length,u=this.get("keymap"),c=o.length-l,h=o.length-1;h>=c&&h>=0;h--){var f=o.pop(),g=this.processDataItemHandler(i,u,f);if(g){var d=this.source.getFeatureById(g.getId());null!=d&&"my"==d.data.type||(s[s.length]=g)}}0==o.length?(n&&this.drawDebugBounds(e),debug().timeEnd("数据处理"+t),this.source.addFeatures(s)):setTimeout((function(){r.processDataHandler_(t,e,n,i,o,s,a)}),2)},this.processDataItemHandler=function(t,e,n){for(var i={},r=0;r<t.length;r++){var o=e[t[r]];o?i[o]=n[r]:i[t[r]]=n[r]}for(r=0;r<t.length;r++)i[e[t[r]]]=n[r];return i.name&&(i.name=i.name.toUpperCase()),i.geom&&(i.center=y.readGeometry(i.geom).getCoordinates()),!i.length&&i.a&&i.b&&(i.length=i.a+i.b),this.processData(i)};var y=new ol.format.WKT;this.onClear=function(t){this.reloadData&&(this._lastExtent=null,this._historyData={},this.reloadData=!1,this.reset())},this.findFilter=function(t,e){if(t&&null!=t.data&&null!=t.data.type&&null!=t.pxBounds&&!1!==t.data.visible){var n=this.getZoom();if("my"==t.data.type||null==this.setting.pointMaxZoom||n>this.setting.pointMaxZoom){for(var i=[],r=0;r<t.pxBounds.length;r++)i[r]=t.pxBounds[r]+t.point[r%2];if(ol.extent.containsCoordinate(i,e.pixel_)&&this.checkShipCondition(t.data))return t}}},this.findShip=function(e,n,i,o){if(this._map.selectedLayer=this.ol_uid,!n){var s=this.findById(e);return this._map.selectedFeature=s,s.getGeometry()&&!1!==o&&t.flyTo(this._map,s.getGeometry(),{maxZoom:10,duration:this.setting.duration}),s}n(this,e,(function(n){debug().log("被搜索船只",n);var s=r.findById(e);s&&s.data&&(n.type=s.data.type,n.fill=s.data.fill);var a=r.processData(n);if(a&&(r.getSource().addFeature(a),r._map.selectedFeature=r.getSource().getFeatureById(n.mmsi),a.getGeometry()&&!1!==o)){var l=r._map.getView().getZoom(),u={duration:r.setting.duration};u.maxZoom=l<10?10:l,t.flyTo(r._map,a.getGeometry(),u)}i&&i(n)}))},this.drawShipBody=function(t,e,n){if(t.path_rings){var i=t.angle*Math.PI/180;if(this.setting.track&&this.setting.track.visible&&this.trackImage&&"ready"==this.trackImage.state&&this.getZoom()>=this.setting.track.zoom&&this.setting.track.withoutStates.indexOf(t.sailStatus)<0&&(new Date).getTime()-t.createdAt<=this.setting.track.timespan){var r=t.speed>40?40:t.speed;this.drawTrack(this.trackImage,e,i,e,("simple"==t.drawType?10:t.breadth/this._map.getView().getResolution())*(r/10<2?2:r/10),r*this.setting.track.delay/this._map.getView().getResolution(),this.setting.track,t)}if(this.drawShipComplex(t.path_rings,n,t.fill,e,i,e),t.speedRings){if(null==t.speed_path){t.speed_path=[];for(var o=t.path_rings[0],s=0;s<t.speedRings.length;s++)t.speed_path[s]=[t.speedRings[s][0]+o[0],t.speedRings[s][1]+o[1]]}this.drawShipDirection(t.speed_path,n,e,i,e)}}},this.drawShipDirection=function(t,e,n,i,r,o){this.drawPloyline(t,e,n,i,r,o)},this.drawShipComplex=function(t,e,n,i,r,o,s){this.drawPloygon(t,e,n,!1,i,r,o,s)},this.drawSatellite=function(t,e,n,i,r,o){this.drawPoint(t,e-1,r),this.drawFontMarker([t[0],t[1]-1],e,n,i,null,o,null)},this.drawTrack=function(t,e,n,i,r,o,s,a){if(this._ctx.save(),this.adaptationPixelRatio(),e&&this._ctx.translate(e[0],e[1]),0!=n&&i&&this._ctx.rotate(n),"complex"==a.drawType&&a.offset&&(0!=a.offset[0]||0!=a.offset[1])){var l=this._map.getPixelFromCoordinate([a.centerPoint[0]-a.offset[0],a.centerPoint[1]-a.offset[1]]),u=[l[0]-e[0],l[1]-e[1]];this._ctx.translate(u[0],-u[1])}this._ctx.drawImage(t,s.left||0,s.top||0,s.width||t.width,s.height||t.height,0-r/2,0,r,o),this._ctx.restore()};var v=function(t,e){if(e>0){for(var n=(new Matrix).rotate(e,0,0,1),i=[ol.extent.getBottomLeft(t.pxBounds),ol.extent.getBottomRight(t.pxBounds),ol.extent.getTopRight(t.pxBounds),ol.extent.getTopLeft(t.pxBounds)],r=[0,0,0,0],o=0;o<i.length;o++)i[o]=n.transformCoordinate(i[o]),ol.extent.extend(r,[i[o][0],i[o][1],i[o][0],i[o][1]]);return r}return null};return this.checkShipCondition=function(t){if(t.type&&"my"==t.type)return!0;var e=this.get("shipCondition");for(var n in e){var i=e[n],r=!1;if(null!=i){if(0==i.length)return!1;for(var o in i){var s=i[o];if("type"==n){if(s==t[n]||s==t[n+"Result"]){r=!0;break}}else if(r=!0,s==t[n]||s==t[n+"Result"]){r=!1;break}}}else r=!0;if(0==r)return!1}return!0},this.getRenderCount=function(){return this.getVisible()&&this.checkZoom()?this.renderCount:0},r}t.extends(n,e),t.layers.ShipLayer=n}(ships)},function(t,e,n){n(0),function(t){ol.interaction.Modify.prototype.setGeometryCoordinates_=function(t,n){if(this.changingFeature_=!0,"Rectangle"==t.type&&this.dragSegments_.length>0){var i=this.dragSegments_[0][0],r=i.index,o=i.depth[0];n=e(t,n,o,r)}t.setCoordinates(n)};var e=function(t,e,n,i){var r=i;return r%2==0?(4==r&&(e[n][0]=e[n][i]),0==r&&(e[n][4]=e[n][i],r=4),e[n][r-1][1]=e[n][i][1],e[n][(r+1)%4][0]=e[n][i][0]):(e[n][r-1][0]=e[n][i][0],e[n][(r+1)%4][1]=e[n][i][1],1==r&&(e[n][4][0]=e[n][i][0]),3==r&&(e[n][4][1]=e[n][i][1])),e};function n(n){this.setting=extend({},{editable:!1,minZoom:2,maxZoom:18,name:"标记图层",iconSrc:"images/ship.png",textBackStyle:"#8c9cad",textStyle:"#fff",fillStyle:"#ffffff",strokeStyle:"#FF6259",selectedStrokeStyle:"#FF3B30",modifyFillStyle:"#ffcc33",font:"600 12px Arial",weight:2,hitTolerance:3,modifyStrokeStyle:"#FF3B30",modifyTextBackStyle:"#1A3A5B",radius:5,duration:1e3,fitPadding:[100,100,100,100],proj:{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}},n),this._map=this.setting.map,delete this.setting.map;var i=t.call(this,this.setting)||this;this.modifyend=function(t){null==t.feature?t.newFeature=t.features.getArray()[0]:t.newFeature=t.feature,("Circle"==t.target.type_||t.features&&"Circle"==t.features.getArray()[0].getGeometry().getType())&&(t.radius=Math.round(t.newFeature.getGeometry().getRadius()),t.newFeature=new ol.Feature(new ol.geom.Point(t.newFeature.getGeometry().getCenter()))),"drawend"==t.type&&(t.feature.setStyle(i.styleFunction),i.editFeature(t.feature),i.lastTempId=(new Date).getTime(),t.feature.setId(i.lastTempId),i.getSource().addFeature(t.feature),i.updateToolControlActive(!1)),t.layer=i,t.type="featureChanged",t.proj=i.setting.proj,i.dispatchEvent(t)};var r=function(t){i.modifyend(t)};this.buildStyleGroup=function(t,e,n,i,r){var o={};return t&&(o.Point=new ol.style.Style({image:t,text:i})),o.Polygon=[new ol.style.Style({stroke:e,text:n})],o.LineString=[new ol.style.Style({stroke:e,text:n})],o.Circle=new ol.style.Style({stroke:e,text:n}),r&&(o.Point=o.Point?[o.Point,r]:r,o.Polygon.push(r),o.LineString.push(r)),o},this.buildStyle=function(){var t=new ol.style.Icon({src:this.get("iconSrc"),scale:.1,anchor:[.5,.96]}),e=new ol.style.Text({font:this.get("font"),backgroundFill:new ol.style.Fill({color:this.get("textBackStyle")}),fill:new ol.style.Fill({color:this.get("textStyle")}),offsetY:-30,padding:[2,2,0,2]}),n=new ol.style.Text({font:this.get("font"),backgroundFill:new ol.style.Fill({color:this.get("textBackStyle")}),fill:new ol.style.Fill({color:this.get("textStyle")}),padding:[2,2,0,2]});if(!this.styles){var r=new ol.style.Stroke({color:this.get("strokeStyle"),width:this.get("weight")});this.styles=this.buildStyleGroup(t,r,n,e)}if(!this.modifyStyles){r=new ol.style.Stroke({color:this.get("modifyStrokeStyle"),width:this.get("weight")});var o=new ol.style.Style({image:new ol.style.Circle({radius:this.get("radius"),stroke:new ol.style.Stroke({color:this.get("strokeStyle"),width:this.get("weight")}),fill:new ol.style.Fill({color:this.get("fillStyle")})}),geometry:function(t){if(i.modifySource&&i.modifySource.getFeatures().length>=0&&(0==i.modifySource.getFeatures().length||i.modifySource.getFeatures()[0].getId()==t.getId())){var e,n=t.getGeometry().getType();switch(n){case"Polygon":e="Rectangle"==t.getGeometry().type?[t.getGeometry().getCoordinates()[0][0],t.getGeometry().getCoordinates()[0][2]]:t.getGeometry().getCoordinates()[0];break;case"LineString":e=t.getGeometry().getCoordinates();break;case"Point":e=[t.getGeometry().getCoordinates()];break;default:debug().warn("未进行识别的类型",n)}return new ol.geom.MultiPoint(e)}}});this.modifyStyles=this.buildStyleGroup(t,r,n,e,o)}this.selectedStyles||(r=new ol.style.Stroke({color:this.get("selectedStrokeStyle"),width:this.get("weight")}),this.selectedStyles=this.buildStyleGroup(t,r,n,e))},this.styleFu=function(t,e){return function(n){if(!1===n.visible)return o;var r=e||n.getGeometry().getType(),s=i[t][r];return s?(Array.isArray(s)?s[0].text_&&s[0].getText().setText(n.get("text")):s.text_&&s.getText().setText(n.get("text")),s):void 0}},this.getSelectedStyleFunction=this.styleFu("selectedStyles"),this.getNormalStyleFunction=this.styleFu("styles"),this.getModifyStyleFunction=this.styleFu("modifyStyles");var o=new ol.style.Style;this.buildStyle();var s=new ol.source.Vector({features:[]});return this.setSource(s),this.setStyle(this.getNormalStyleFunction),this.select=new ol.interaction.Select({condition:ol.events.condition.pointerMove,layers:[this],hitTolerance:this.setting.hitTolerance,source:s,filter:function(t){return!(!t.getId()||"Point"==t.getGeometry().getType()||null!=i.modifySource&&i.modifySource.getFeatures().length>0&&i.modifySource.getFeatures()[0].getId()==t.getId())},style:this.getSelectedStyleFunction}),this._map.addInteraction(this.select),this.getProj=function(){return this.get("proj")},this.populate=function(t){var e=[],n=new ol.format.WKT;for(var i in t){var r=n.readFeature(t[i].gis,this.getProj()),o=t[i].perimeter/(2*Math.PI);r.getGeometry().type=t[i].type,"Circle"===t[i].type&&(r=new ol.Feature(new ol.geom.Circle(r.getGeometry().flatCoordinates,o)));var s="";"Polygon"===r.getGeometry().getType()?s=","+(r.getGeometry().getArea()/3429904).toFixed(4)+"nm²":"Circle"===r.getGeometry().getType()?s=","+(Math.PI*o*o/3429904).toFixed(4)+"nm²":"LineString"===r.getGeometry().getType()&&(s=","+(r.getGeometry().getLength()/1852).toFixed(4)+"nm");var a=t[i].name+s;r.set("text",a),r.setId(t[i].id),r.visible=1==t[i].isShow,e.push(r)}this.getSource().clear(),this.getSource().addFeatures(e),this.stopEditFeature(),this.changed()},this.setEditable=function(t){t!=this.getEditable()&&(this.set("editable",t),t||this.stopEditFeature())},this.editFeature=function(t,e,n){if(this._map){this.stopEditFeature(),"Rectangle"==e&&null!=t&&(t.getGeometry().type=e),t&&t.setStyle(this.getModifyStyleFunction);var i=t?[t]:[];n&&null!=t&&new Error("新增图元时，不允许同时编辑图元，详细查看api");var o,s,a=new ol.source.Vector({features:i});this.modifySource=a,1!=n?(this.snap=new ol.interaction.Snap({source:a,pixelTolerance:8}),this._map.addInteraction(this.snap)):("Rectangle"===e&&(s=2,e="LineString",o=function(t,e){e||(e=new ol.geom.Polygon([]));var n=t[0],i=t[1];return e.setCoordinates([[n,[n[0],i[1]],i,[i[0],n[1]],n]]),e.type="Rectangle",e}),this.draw=new ol.interaction.Draw({type:e,source:this.modifySource,style:this.styleFu("modifyStyles",e),geometryFunction:o,maxPoints:s}),this._map.addInteraction(this.draw),this.draw.on("drawend",r),this.updateToolControlActive(!1)),this.modify=new ol.interaction.Modify({source:a}),this._map.addInteraction(this.modify),this.modifyHandler=this.modify.on("modifyend",r)}},this.stopEditFeature=function(){if(this._map){if(this.lastTempId){var t=this.getSource().getFeatureById(this.lastTempId);t&&this.getSource().removeFeature(t),this.lastTempId=null}this.modify&&(this.modify.un("modifyend",r),this._map.removeInteraction(this.modify)),this.snap&&this._map.removeInteraction(this.snap),this.draw&&(this.draw.un("drawend",r),this._map.removeInteraction(this.draw)),this.modifySource&&this.modifySource.getFeatures().length>0&&this.modifySource.getFeatures()[0].setStyle(null),this.modifySource=null,this.updateToolControlActive(!0)}},this.updateToolControlActive=function(t){for(var e in map.getInteractions().getArray())map.getInteractions().getArray()[e]instanceof ol.interaction.DoubleClickZoom&&map.getInteractions().getArray()[e].setActive(t)},this.getEditable=function(t){return this.get("editable")},this.updateFeatureCoordinate=function(t,n,i,r){if(t&&n){var o=t.getGeometry();"Circle"==o.getType()?(n&&o.setCenter(n),i&&o.getRadius()!=i&&o.setRadius(i)):("Rectangle"==o.type&&e(o,n,0,r),"Polygon"==o.type&&function(t,e,n,i){var r=e[0].length-1,o=i;0===o&&(e[0][r]=e[0][0]),o===r&&(e[0][0]=e[0][r])}(0,n,0,r),o.setCoordinates(n));var s={type:"featureChanged",feature:t,layer:this,proj:this.get("proj")};s.feature&&"Circle"==s.feature.getGeometry().getType()?(s.radius=Math.round(s.feature.getGeometry().getRadius()),s.newFeature=new ol.Feature(new ol.geom.Point(s.feature.getGeometry().getCenter()))):s.newFeature=t,this.dispatchEvent(s)}},this.addNewGeometry=function(t){this._map&&(this.stopEditFeature(),this.editFeature(null,t,!0))},this.removeById=function(t){var e=this.getSource().getFeatureById(t);e&&this.getSource().removeFeature(e)},this.findById=function(t){return this.getSource().getFeatureById(t)},this.featureLocation=function(t){t&&("Point"==t.getGeometry().getType()?this._map.getView().fit(t.getGeometry(),{padding:this.get("fitPadding"),duration:this.get("duration"),maxZoom:10}):this._map.getView().fit(t.getGeometry(),{padding:this.get("fitPadding"),duration:this.get("duration")}))},i}ol.interaction.Modify.prototype.writePolygonGeometry_=function(t,e){var n=e.getCoordinates(),i=2,r=1;"Rectangle"==e.type&&(i=1,r=2);for(var o=0,s=n.length;o<s;++o)for(var a=n[o],l=0,u=a.length-1;l<u;l+=r){var c=a.slice(l,l+i);1==c.length&&(c=c.concat(c));var h={feature:t,geometry:e,depth:[o],index:l,segment:c};this.rBush_.insert(ol.extent.boundingExtent(c),h)}},ships.extends(n,t),window.ships.layers.MarkerLayer=n}(ol.layer.Vector)},function(t,e,n){n(1),function(t){var e=t.layers.RenderLayer;function n(n){this.setting=extend({},{pointColor:"orange",firstPointColor:"red",lastPointColor:"blue",name:"trackLayer",distance:80,radius:5,mapType:{MT_GOOGLE:["lightMapActive","lightMapUnactive"],MT_SATELLITE:["darkMapActive","darkMapunActive"],MT_OSM:["lightMapActive","lightMapUnactive"]},totalColor:{lightMapActive:{pointColor:"#fff",firstPointColor:"orange",lastPointColor:"red",strokeStyle:"#163DD4",labelLineStyle:"#163DD4",showLabel:!0},lightMapUnactive:{pointColor:"rgba(255,255,255,.4)",firstPointColor:"rgba(255,165,0,.4)",lastPointColor:"rgba(255,0,0,.4)",strokeStyle:"rgba(111,155,238,.4)",labelLineStyle:"rgba(111,155,238,.4)",showLabel:!1},darkMapActive:{pointColor:"#fff",firstPointColor:"orange",lastPointColor:"red",strokeStyle:"#00FF00",labelLineStyle:"#00FF00",showLabel:!0},darkMapunActive:{pointColor:"rgba(255,255,255,.4)",firstPointColor:"rgba(255,165,0,.4)",lastPointColor:"rgba(255,0,0,.4)",strokeStyle:"rgba(0,255,0,.4)",labelLineStyle:"rgba(0,255,0,.4)",showLabel:!1}},renderOrder:function(t,e){var n=t.order-e.order;return 0==n?e.id_-t.id_:n},arrowBounds:[[0,4],[5,0],[0,-4]]},n);var i=e.call(this,this.setting)||this,r=new ol.style.Style({renderer:function(t,e){i.renderPoint(t,e)}});return this.lineStyle=new ol.style.Style({stroke:new ol.style.Stroke({color:i.setting.strokeStyle,width:i.setting.weight})}),this.renderPoint=function(t,e){this._pixelRatio&&this._pixelRatio==e.pixelRatio||(this._pixelRatio=e.pixelRatio);var n=this._map.getPixelFromCoordinate(e.feature.data.centerPoint);if(n=this.calcPoint(n,e.feature,e.feature.getId()==this.firstId)){var i=this.setting.pointColor,r=this.setting.otherFont||null;if(e.feature.getId()==this.lastId?(this.max=3,i=this.setting.lastPointColor,r=this.setting.PointFont||null):e.feature.getId()==this.firstId&&(i=this.setting.firstPointColor,r=this.setting.PointFont||null),r?this.drawFontMarker(n,8,r,i,null,"normal 16px iconfont"):this.drawPoint(n,this.setting.radius,this.setting.strokeStyle,i),this.areas.length>=this.max){var o=this.areas[this.areas.length-2],s=this.areas[this.areas.length-1],a=this.calcArrow(o.id_,s.id_);a&&this.drawArrow(this.setting.arrowBounds,a.point,a.angle,a.point,!0)}this.renderingCount++}},this.calcArrow=function(t,e){var n,i,r,o=(t+e)/2;if((t+e)%2==0?(n=this.getPoint(o),i=this.getPoint(o-1),r=this.getPoint(o+1)):(i=this.getPoint(Math.floor(o)),r=this.getPoint(Math.ceil(o)),i&&r&&(n=[(i[0]+r[0])/2,(i[1]+r[1])/2])),i&&r&&n){var s=this.calcAngle(i,r);return isNaN(s)&&(s=0),{point:n,angle:s,pre:i,next:r}}},this.getPoint=function(t){var e=this.getSource().getFeatureById(t);if(e)return this._map.getPixelFromCoordinate(e.getGeometry().getCoordinates())},this.calcPoint=function(e,n,r){for(var o=e.concat(e),s=t.addExtent(o,[this.setting.distance,this.setting.distance]),a=0;a<i.areas.length;a++){if(1!=r&&ol.extent.intersects(s,i.areas[a].bounds))return;if(n.id_==i.areas[a].id_)return}return n.bounds=s,n.point=e,this.areas.push(n),e},this.findFilter=function(t){if(t.get("name")!=this.get("name")&&this.areas&&this.areas.length>0)for(var e=0;e<this.areas.length;e++)if(this.areas[e].getId()==t.getId())return t},this.onPreRender=function(t){this._ctx=t.context,this._map.labels=[],this.areas=[],this.renderingCount=0,this.max=2},this.onPostRender=function(t){if(this.areas.length>=1){var e=this.areas[this.areas.length-1],n=e.id_==this.lastId?this.firstId:e.id_,i=this.calcArrow(n,this.lastId);i&&this.drawArrow(this.setting.arrowBounds,i.point,i.angle,i.point,!0)}if(this.setting.showLabel)for(var r=0;r<this.areas.length;r++)if(s=this.areas[r]){var o=s.point;this.drawLabel(o,s.get("name"),this.setting.labelLineStyle,this.setting.textStyle,this.setting.textBackStyle,null,20,20,this.setting.lineWeight)}if(this.renderCount=this.renderingCount,this.needFlyTo){var s=this.getSource().getFeatureById(this.get("name"));this.needFlyTo=!1,s&&this._map.getView().fit(s.getGeometry(),{duration:this.setting.duration,padding:[0,0,50,0]})}this._map.lastOnLayer==this.ol_uid&&(this._ctx=t.context,this._map.lastOn&&this.selectPoint(this._map.lastOn))},this.selectPoint=function(t){var e=t.point;if(this._pixelRatio&&(e=this._map.getPixelFromCoordinate(t.data.centerPoint)),e){var n=this.setting.pointColor,i=this.setting.otherFont||null;t.getId()==this.lastId?(n=this.setting.lastPointColor,i=this.setting.PointFont||null):t.getId()==this.firstId&&(n=this.setting.firstPointColor,i=this.setting.PointFont||null),i?this.drawFontMarker(e,8,i,n,null,"bold 16px iconfont"):this.drawPoint(e,this.setting.radius+2,this.setting.strokeStyle,n)}},this.populate=function(e,n){if(e)for(var i in n&&(this.lastExtent=t.getWrapExtent(this._map)),e){this.set("name",i);var r=e[i],o=this.buildPoint(r);this.getSource().clear(),this.needFlyTo=!0,this.getSource().addFeatures(o)}},this.buildPoint=function(e){var n=[],i=[];this.dataCount=e.length,this.lastId=0,this.firstId=e.length-1;for(var r=0;r<e.length;r++){var o=e[r],s=t.fromLonLat(t.encodeCoordinate(o.center||[1*o.lon,1*o.lat],t.geometrys.china));o.center=[1*o.lon,1*o.lat],o.centerPoint=s,i[r]=this._project(o,r),n[r]=i[r].data.centerPoint}if(i.length>0){i[0].order=-1;var a=new ol.geom.LineString(n),l=new ol.Feature(a);l.set("meta",a.getLength()),l.setId(this.get("name")),l.set("name",this.get("name")),l.setStyle(this.lineStyle),l.order=-2,i.unshift(l)}return i},this.changeCoding=function(e){debug().log(this.getSource());for(var n=this.getSource().getFeatures(),i=0;i<n.length;i++)n[i].data&&n[i].data.center&&n[i].getId()!=this.get("name")&&this._project(n[i].data,n[i].getId());var r=this.getSource().getFeatureById(this.get("name"));if(r){var o=r.getGeometry().getCoordinates(),s=[];for(i=0;i<o.length;i++){t.codingCoordinate=!e;var a=t.decodeCoordinate(t.toLonLat(o[i]),t.geometrys.china);t.codingCoordinate=e,s.push(t.fromLonLat(t.encodeCoordinate(a,t.geometrys.china)))}r.getGeometry().setCoordinates(s)}},this._project=function(e,n){var i=this.getSource().getFeatureById(n);if((!i||i.getId()!=this.get("name"))&&e.center)return e.centerPoint=new t.fromLonLat(t.encodeCoordinate(e.center,t.geometrys.china)),null==i?((i=new ol.Feature(new ol.geom.Point(e.centerPoint))).setStyle(r),i.setId(n),i.set("name",new Date(1*e.createdAt).format("yyyy-MM-dd HH:mm:ss")),i.data=e,i.order=0):(i.data=e,i.setGeometry(new ol.geom.Point(e.centerPoint))),i},i}t.extends(n,e),window.ships.layers.TrackLayer=n}(ships)},function(t,e,n){n(1),function(t){var e=t.layers.RenderLayer;function n(n){this.setting=extend({},{fontStyle:"normal 20px iconfont",text:"&#xe662",fillStyle:"red",boundsOutSize:14,minZoom:3,maxZoom:18,zIndex:2,py:4,radius:10,textBackStyle:"rgba(51,51,51,.6)",offsetY:-20,offsetX:0,extentCombine:!1,maxKeepTime:144e5,portcomplex:{path_rings:[[12,-12],[12,12],[-12,-12],[-12,12]],center:[0,0],bounds:[-12,-12,12,12]},keymap:{id:"id",name:"name",cen:"center",type:"type",geom:"geom",time:"createdAt",g:"group"}},n);var i=new ol.style.Style({renderer:function(t,e){for(var n=0;n<s.renderAreas.length;n++)s.renderIcon(t,e,s.renderAreas[n])}});this.getStyles=function(t){return function(t){var e=s._map.getView().getZoom(),n=[i],r=s.getVisible()&&s.setting.showLabel&&(null==s.setting.labelMinZoom||e>=s.setting.labelMinZoom)&&(null==s.setting.labelMaxZoom||e<=s.setting.labelMaxZoom);if(r||!r&&s._checkSelf(s._map.selectedFeature,t)){if(0==s.setting.iconFont[t.data.type].visible)return;if(s.setting.iconFont[t.data.type].minZoom>s.getZoom())debug().log("离开显示范围");else{var o=t.data.name||t.data.cnName||t.data.enName;s.labelStyle.getText().setText(o),n.push(s.labelStyle)}}return n}},this.callData=function(t){var e=this.handleZoomChanging(),n=this.getMapExtent(t,!e&&this.setting.extentCombine,!0);if(null!=n){var i=extend({},t);i.type="getData",i.extent=n,i.target=this,i.zoom=this.getZoom(),i.zoomChanged=e,this.dispatchEvent(i)}},this.reset=function(t){this._map||(this._map=t.map),this.getVisible()&&this.checkZoom(t)&&this.callData(t)},this._updateData=function(t){if(this._map&&this.getVisible()){var e={map:this._map};this.checkZoom(e)&&(this._lastExtent=null,this.callData(e))}},this.setVisibleWithType=function(t,e){e?this.setting.iconFont[e]&&(this.setting.iconFont[e].visible=t,this.changed()):this.setVisible(t)},this.onPostRender=function(t){this._map.selectedFeature&&this.renderSelected(this._map.selectedFeature,!0,!0),this._map.lastOnLayer==this.ol_uid&&(this._ctx=t.context,this._map.lastOn&&(this._checkSelf(this._map.selectedFeature,this._map.lastOn)||this.renderSelected(this._map.lastOn,!1,!1)))},this.beforeRender=function(t){},this.handleZoomChanged=function(t){t&&(debug().log("层级减少，清理图元"),this.clearFeatures())},this.handleZoomChanging=function(){var t=!1;return this._lastZoom>this.getZoom()&&(t=!0),this._lastZoom!=this.getZoom()&&(this._lastExtent=null,this._lastZoom=this.getZoom()),t},this.renderIcon=function(t,e,n){this._pixelRatio&&this._pixelRatio==e.pixelRatio||(this._pixelRatio=e.pixelRatio),this._map&&0!=this.setting.iconFont[e.feature.data.type].visible&&(this.setting.iconFont[e.feature.data.type].minZoom>this.getZoom()||(this._pixelRatio&&(t=this._map.getPixelFromCoordinate(e.feature.data.centerPoint)),0!=n&&(t[0]=t[0]+n),this.drawIcon(t,e)))},this.renderSelected=function(t,e,n){var i=this.setting.stroke?t.data.stroke||"black":null;if(this.setting.selectedStyle&&(i=this.setting.selectedStyle),this.setting.iconFont[t.data.type]){var r=this.setting.iconFont[t.data.type].hoverIcon;e&&(r=this.setting.iconFont[t.data.type].clickIcon);var o=t.point;this._pixelRatio&&(o=this._map.getPixelFromCoordinate(t.data.centerPoint)),this.pageRenderFont(t.data,o,r),e&&(t.data.pxBounds||(t.data.pxBounds=this.setting.portcomplex.bounds),this.drawSelectedBounds(t.data.pxBounds,i,o))}},this.populate=function(t,e){t.result&&this.processDataHandler(t,e)},this.processDataHandler=function(t,e){if(this.handleZoomChanged(e),t.map){var n=t.data;if(n&&n.length>0){for(var i=this.getZoom(),r=[],o=t.map,s=this.get("keymap"),a=0;a<n.length;a++){var l=this.processDataItemHandler(o,s,n[a]);if(this.setting.iconFont[l.type]){if(l.createdAt){var u=((new Date).getTime()-1*l.createdAt)/36e5;if("NETSONDE"==l.type&&u>4)continue}var c=null;this.setting.iconFont[l.type].minZoom?i>=this.setting.iconFont[l.type].minZoom&&(c=this.processData(l)):c=this.processData(l),c&&r.push(c)}}this.getSource().addFeatures(r)}}else this.processDataHandler_(t)},this.processDataItemHandler=function(t,e,n){for(var i={},o=0;o<t.length;o++)e[t[o]]&&(i[e[t[o]]]=n[o]);return i.name&&(i.name=i.name.toUpperCase()),i.geom&&(i.center=r.readGeometry(i.geom).getCoordinates()),i.group&&(i.type=i.group),i};var r=new ol.format.WKT;this.processDataHandler_=function(t){var e=[];if(t.data&&t.data.length>0){var n=t.data;if(n&&n.length>0){for(var i=0;i<n.length;i++)if(this.setting.iconFont[n[i].type]){n[i].center=[1*n[i].longitude,1*n[i].latitude];var r=this.processData(n[i]);r&&e.push(r)}this.getSource().addFeatures(e)}}};var o=!1;this.clearFeatures=function(){o=!1,this.getSource()&&(this._map.selectedLayer==this.ol_uid&&this._map.selectedFeature&&this._map.selectedFeature.data&&this.setting.iconFont[this._map.selectedFeature.data.type]&&!1!==this.setting.iconFont[this._map.selectedFeature.data.type].visible?1==this.getSource().getFeatures().length&&this._checkSelf(this._map.selectedFeature,this.getSource().getFeatures()[0])||(o=!0,this.getSource().clear()):this.getSource().clear())},this.onClear=function(t){o&&(debug().log("捕获到数据源清除事件",this.get("name"),t),this.getSource().addFeature(this._map.selectedFeature),debug().log(this.getSource().getFeatures().length,this._map.selectedFeature))},this.processData=function(t){if(t.center)return this._project(t)},this._project=function(e){var n=this.getSource().getFeatureById(e.id);if(e.center)return e.centerPoint=new t.fromLonLat(t.encodeCoordinate(e.center,t.geometrys.china)),null==n?((n=new ol.Feature(new ol.geom.Point(e.centerPoint))).setId(e.id),n.data=e,n.setStyle(this.getStyles()),n.order=this.setting.iconFont[e.type].order||0):(n.data=e,n.setGeometry(new ol.geom.Point(e.centerPoint))),n},this.drawIcon=function(t,e){if(e.feature.point=t,!this._checkSelf(this._map.selectedFeature,e.feature)){var n=e.feature.data;n.pxBounds||(n.pxBounds=this.setting.portcomplex.bounds),this.pageRenderFont(n,t,s.setting.iconFont[n.type].icon)}},this.pageRenderFont=function(t,e,n){var i=s.setting.iconFont[t.type].icon.style||this.setting.fontStyle;if("NETSONDE"==t.type)if(t.createdAt){var r=((new Date).getTime()-1*t.createdAt)/36e5;t.fill=r<=.5?"orange":r>.5&&r<=4?"#ffa500ba":"#999"}else t.fill="#999";"BASE"==t.type&&"ERROR"==t.deviceStatus&&(t.fill="red"),this.drawFontMarker([e[0],e[1]-this.setting.py],this.setting.radius,n.text,t.fill||s.setting.iconFont[t.type].color,null,i)},this.findFilter=function(t,e){var n=this._map.getView().getZoom();if(t&&null!=t.data&&null!=t.data.pxBounds&&!1!==this.getVisible()){if(this.setting.iconFont[t.data.type]){if(this.setting.iconFont[t.data.type].minZoom&&this.setting.iconFont[t.data.type].minZoom>n)return;if(!1===this.setting.iconFont[t.data.type].visible)return}for(var i=[],r=this._map.getPixelFromCoordinate(t.data.centerPoint),o=0;o<t.data.pxBounds.length;o++)i[o]=t.data.pxBounds[o]+r[o%2];return ol.extent.containsCoordinate(i,e.pixel_)?t:void 0}},this.changeCoding=function(e){for(var n=this.getSource().getFeaturesInExtent(t.getWrapExtent(this._map)),i=0;i<n.length;i++)if(n[i].data&&n[i].data.center){var r=this._project(n[i].data);r&&(n[i]=r)}};var s=e.call(this,this.setting)||this;return s.labelStyle=new ol.style.Style({text:new ol.style.Text({font:s.get("font"),backgroundFill:new ol.style.Fill({color:s.get("textBackStyle")}),fill:new ol.style.Fill({color:s.get("textStyle")}),offsetX:s.get("offsetX"),offsetY:s.get("offsetY"),padding:[2,0,0,2],textAlign:"center",textBaseline:"bottom"})}),s}t.extends(n,e),t.layers.IconfontLayer=n}(ships)}])},function(t,e,n){n(42)("Float32",4,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},function(t,e,n){t.exports=n(25)("native-function-to-string",Function.toString)},function(t,e,n){"use strict";var i=n(3),r=n(1),o=n(15),s=n(45),a=n(7),l=n(46),u=n(2),c=n(47),h=n(14),f=n(11),g=n(48),d=n(16).f,p=n(5).f,m=n(36),y=n(29),v=i.ArrayBuffer,x=i.DataView,w=i.Math,S=i.RangeError,_=i.Infinity,b=v,P=w.abs,C=w.pow,F=w.floor,I=w.log,k=w.LN2,M=r?"_b":"buffer",T=r?"_l":"byteLength",E=r?"_o":"byteOffset";function L(t,e,n){var i,r,o,s=new Array(n),a=8*n-e-1,l=(1<<a)-1,u=l>>1,c=23===e?C(2,-24)-C(2,-77):0,h=0,f=t<0||0===t&&1/t<0?1:0;for((t=P(t))!=t||t===_?(r=t!=t?1:0,i=l):(i=F(I(t)/k),t*(o=C(2,-i))<1&&(i--,o*=2),(t+=i+u>=1?c/o:c*C(2,1-u))*o>=2&&(i++,o/=2),i+u>=l?(r=0,i=l):i+u>=1?(r=(t*o-1)*C(2,e),i+=u):(r=t*C(2,u-1)*C(2,e),i=0));e>=8;s[h++]=255&r,r/=256,e-=8);for(i=i<<e|r,a+=e;a>0;s[h++]=255&i,i/=256,a-=8);return s[--h]|=128*f,s}function A(t,e,n){var i,r=8*n-e-1,o=(1<<r)-1,s=o>>1,a=r-7,l=n-1,u=t[l--],c=127&u;for(u>>=7;a>0;c=256*c+t[l],l--,a-=8);for(i=c&(1<<-a)-1,c>>=-a,a+=e;a>0;i=256*i+t[l],l--,a-=8);if(0===c)c=1-s;else{if(c===o)return i?NaN:u?-_:_;i+=C(2,e),c-=s}return(u?-1:1)*i*C(2,c-e)}function O(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function R(t){return[255&t]}function D(t){return[255&t,t>>8&255]}function j(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function V(t){return L(t,52,8)}function B(t){return L(t,23,4)}function G(t,e,n){p(t.prototype,e,{get:function(){return this[n]}})}function N(t,e,n,i){var r=g(+n);if(r+e>t[T])throw S("Wrong index!");var o=t[M]._b,s=r+t[E],a=o.slice(s,s+e);return i?a:a.reverse()}function Z(t,e,n,i,r,o){var s=g(+n);if(s+e>t[T])throw S("Wrong index!");for(var a=t[M]._b,l=s+t[E],u=i(+r),c=0;c<e;c++)a[l+c]=u[o?c:e-c-1]}if(s.ABV){if(!u((function(){v(1)}))||!u((function(){new v(-1)}))||u((function(){return new v,new v(1.5),new v(NaN),"ArrayBuffer"!=v.name}))){for(var z,H=(v=function(t){return c(this,v),new b(g(t))}).prototype=b.prototype,U=d(b),W=0;U.length>W;)(z=U[W++])in v||a(v,z,b[z]);o||(H.constructor=v)}var q=new x(new v(2)),Y=x.prototype.setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||l(x.prototype,{setInt8:function(t,e){Y.call(this,t,e<<24>>24)},setUint8:function(t,e){Y.call(this,t,e<<24>>24)}},!0)}else v=function(t){c(this,v,"ArrayBuffer");var e=g(t);this._b=m.call(new Array(e),0),this[T]=e},x=function(t,e,n){c(this,x,"DataView"),c(t,v,"DataView");var i=t[T],r=h(e);if(r<0||r>i)throw S("Wrong offset!");if(r+(n=void 0===n?i-r:f(n))>i)throw S("Wrong length!");this[M]=t,this[E]=r,this[T]=n},r&&(G(v,"byteLength","_l"),G(x,"buffer","_b"),G(x,"byteLength","_l"),G(x,"byteOffset","_o")),l(x.prototype,{getInt8:function(t){return N(this,1,t)[0]<<24>>24},getUint8:function(t){return N(this,1,t)[0]},getInt16:function(t){var e=N(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=N(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return O(N(this,4,t,arguments[1]))},getUint32:function(t){return O(N(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return A(N(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return A(N(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){Z(this,1,t,R,e)},setUint8:function(t,e){Z(this,1,t,R,e)},setInt16:function(t,e){Z(this,2,t,D,e,arguments[2])},setUint16:function(t,e){Z(this,2,t,D,e,arguments[2])},setInt32:function(t,e){Z(this,4,t,j,e,arguments[2])},setUint32:function(t,e){Z(this,4,t,j,e,arguments[2])},setFloat32:function(t,e){Z(this,4,t,B,e,arguments[2])},setFloat64:function(t,e){Z(this,8,t,V,e,arguments[2])}});y(v,"ArrayBuffer"),y(x,"DataView"),a(x.prototype,s.VIEW,!0),e.ArrayBuffer=v,e.DataView=x},function(t,e,n){var i=n(23),r=n(0)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(5),r=n(8),o=n(37);t.exports=n(1)?Object.defineProperties:function(t,e){r(t);for(var n,s=o(e),a=s.length,l=0;a>l;)i.f(t,n=s[l++],e[n]);return t}},function(t,e,n){var i=n(3).document;t.exports=i&&i.documentElement},function(t,e,n){var i=n(30),r=n(0)("iterator"),o=n(23);t.exports=n(18).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var i=n(75);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){var i=n(6),r=n(38),o=n(0)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var i=n(54),r=n(77),o=n(23),s=n(17);t.exports=n(78)(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var i=n(15),r=n(4),o=n(9),s=n(7),a=n(23),l=n(79),u=n(29),c=n(51),h=n(0)("iterator"),f=!([].keys&&"next"in[].keys()),g=function(){return this};t.exports=function(t,e,n,d,p,m,y){l(n,e,d);var v,x,w,S=function(t){if(!f&&t in C)return C[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},_=e+" Iterator",b="values"==p,P=!1,C=t.prototype,F=C[h]||C["@@iterator"]||p&&C[p],I=F||S(p),k=p?b?S("entries"):I:void 0,M="Array"==e&&C.entries||F;if(M&&(w=c(M.call(new t)))!==Object.prototype&&w.next&&(u(w,_,!0),i||"function"==typeof w[h]||s(w,h,g)),b&&F&&"values"!==F.name&&(P=!0,I=function(){return F.call(this)}),i&&!y||!f&&!P&&C[h]||s(C,h,I),a[e]=I,a[_]=g,p)if(v={values:b?I:S("values"),keys:m?I:S("keys"),entries:k},y)for(x in v)x in C||o(C,x,v[x]);else r(r.P+r.F*(f||P),e,v);return v}},function(t,e,n){"use strict";var i=n(24),r=n(20),o=n(29),s={};n(7)(s,n(0)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var i=n(0)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],s=o[i]();s.next=function(){return{done:n=!0}},o[i]=function(){return s},t(o)}catch(t){}return n}},function(t,e,n){"use strict";var i=n(12),r=n(28),o=n(11);t.exports=[].copyWithin||function(t,e){var n=i(this),s=o(n.length),a=r(t,s),l=r(e,s),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?s:r(u,s))-l,s-a),h=1;for(l<a&&a<l+c&&(h=-1,l+=c-1,a+=c-1);c-- >0;)l in n?n[a]=n[l]:delete n[a],a+=h,l+=h;return n}},function(t,e,n){"use strict";n(83);var i=n(8),r=n(32),o=n(1),s=/./.toString,a=function(t){n(9)(RegExp.prototype,"toString",t,!0)};n(2)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?a((function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)})):"toString"!=s.name&&a((function(){return s.call(this)}))},function(t,e,n){n(1)&&"g"!=/./g.flags&&n(5).f(RegExp.prototype,"flags",{configurable:!0,get:n(32)})},function(t,e,n){var i=Date.prototype,r=i.toString,o=i.getTime;new Date(NaN)+""!="Invalid Date"&&n(9)(i,"toString",(function(){var t=o.call(this);return t==t?r.call(this):"Invalid Date"}))},function(t,e,n){"use strict";var i=n(30),r={};r[n(0)("toStringTag")]="z",r+""!="[object z]"&&n(9)(Object.prototype,"toString",(function(){return"[object "+i(this)+"]"}),!0)},function(t,e,n){var i=n(3),r=n(56),o=n(5).f,s=n(16).f,a=n(58),l=n(32),u=i.RegExp,c=u,h=u.prototype,f=/a/g,g=/a/g,d=new u(f)!==f;if(n(1)&&(!d||n(2)((function(){return g[n(0)("match")]=!1,u(f)!=f||u(g)==g||"/a/i"!=u(f,"i")})))){u=function(t,e){var n=this instanceof u,i=a(t),o=void 0===e;return!n&&i&&t.constructor===u&&o?t:r(d?new c(i&&!o?t.source:t,e):c((i=t instanceof u)?t.source:t,i&&o?l.call(t):e),n?this:h,u)};for(var p=function(t){t in u||o(u,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},m=s(c),y=0;m.length>y;)p(m[y++]);h.constructor=u,u.prototype=h,n(9)(i,"RegExp",u)}n(55)("RegExp")},function(t,e,n){"use strict";n(59)("trim",(function(t){return function(){return t(this,3)}}))},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var i=n(4);i(i.S,"Array",{isArray:n(38)})},function(t,e,n){var i=n(4);i(i.P,"Array",{fill:n(36)}),n(54)("fill")},function(t,e,n){"use strict";var i=n(4),r=n(27),o=n(12),s=n(2),a=[].sort,l=[1,2,3];i(i.P+i.F*(s((function(){l.sort(void 0)}))||!s((function(){l.sort(null)}))||!n(40)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),r(t))}})},function(t,e,n){"use strict";var i=n(3),r=n(10),o=n(21),s=n(56),a=n(19),l=n(2),u=n(16).f,c=n(31).f,h=n(5).f,f=n(59).trim,g=i.Number,d=g,p=g.prototype,m="Number"==o(n(24)(p)),y="trim"in String.prototype,v=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){var n,i,r,o=(e=y?e.trim():f(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var s,l=e.slice(2),u=0,c=l.length;u<c;u++)if((s=l.charCodeAt(u))<48||s>r)return NaN;return parseInt(l,i)}}return+e};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof g&&(m?l((function(){p.valueOf.call(n)})):"Number"!=o(n))?s(new d(v(e)),n,g):v(e)};for(var x,w=n(1)?u(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)r(d,x=w[S])&&!r(g,x)&&h(g,x,c(d,x));g.prototype=p,p.constructor=g,n(9)(i,"Number",g)}},function(t,e,n){var i=n(5).f,r=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in r||n(1)&&i(r,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var i=n(4),r=n(33)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(s||!n(40)(o)),"Array",{indexOf:function(t){return s?o.apply(this,arguments)||0:r(this,t,arguments[1])}})},function(t,e,n){var i=n(4);i(i.S,"Object",{setPrototypeOf:n(57).set})},function(t,e,n){n(42)("Uint8",1,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},function(t,e,n){"use strict";var i=n(4),r=n(52)(1);i(i.P+i.F*!n(40)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(8),r=n(12),o=n(11),s=n(14),a=n(60),l=n(61),u=Math.max,c=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,g=/\$([$&`']|\d\d?)/g;n(62)("replace",2,(function(t,e,n,d){return[function(i,r){var o=t(this),s=null==i?void 0:i[e];return void 0!==s?s.call(i,o,r):n.call(String(o),i,r)},function(t,e){var r=d(n,t,this,e);if(r.done)return r.value;var h=i(t),f=String(this),g="function"==typeof e;g||(e=String(e));var m=h.global;if(m){var y=h.unicode;h.lastIndex=0}for(var v=[];;){var x=l(h,f);if(null===x)break;if(v.push(x),!m)break;""===String(x[0])&&(h.lastIndex=a(f,o(h.lastIndex),y))}for(var w,S="",_=0,b=0;b<v.length;b++){x=v[b];for(var P=String(x[0]),C=u(c(s(x.index),f.length),0),F=[],I=1;I<x.length;I++)F.push(void 0===(w=x[I])?w:String(w));var k=x.groups;if(g){var M=[P].concat(F,C,f);void 0!==k&&M.push(k);var T=String(e.apply(void 0,M))}else T=p(P,f,C,F,k,e);C>=_&&(S+=f.slice(_,C)+T,_=C+P.length)}return S+f.slice(_)}];function p(t,e,i,o,s,a){var l=i+t.length,u=o.length,c=g;return void 0!==s&&(s=r(s),c=f),n.call(a,c,(function(n,r){var a;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(l);case"<":a=s[r.slice(1,-1)];break;default:var c=+r;if(0===c)return n;if(c>u){var f=h(c/10);return 0===f?n:f<=u?void 0===o[f-1]?r.charAt(1):o[f-1]+r.charAt(1):n}a=o[c-1]}return void 0===a?"":a}))}}))},function(t,e,n){var i=n(14),r=n(22);t.exports=function(t){return function(e,n){var o,s,a=String(r(e)),l=i(n),u=a.length;return l<0||l>=u?t?"":void 0:(o=a.charCodeAt(l))<55296||o>56319||l+1===u||(s=a.charCodeAt(l+1))<56320||s>57343?t?a.charAt(l):o:t?a.slice(l,l+2):s-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var i=n(41);n(4)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(t,e,n){"use strict";var i=n(58),r=n(8),o=n(53),s=n(60),a=n(11),l=n(61),u=n(41),c=n(2),h=Math.min,f=[].push,g="length",d=!c((function(){RegExp(4294967295,"y")}));n(62)("split",2,(function(t,e,n,c){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[g]||2!="ab".split(/(?:ab)*/)[g]||4!=".".split(/(.?)(.?)/)[g]||".".split(/()()/)[g]>1||"".split(/.?/)[g]?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!i(t))return n.call(r,t,e);for(var o,s,a,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,d=void 0===e?4294967295:e>>>0,p=new RegExp(t.source,c+"g");(o=u.call(p,r))&&!((s=p.lastIndex)>h&&(l.push(r.slice(h,o.index)),o[g]>1&&o.index<r[g]&&f.apply(l,o.slice(1)),a=o[0][g],h=s,l[g]>=d));)p.lastIndex===o.index&&p.lastIndex++;return h===r[g]?!a&&p.test("")||l.push(""):l.push(r.slice(h)),l[g]>d?l.slice(0,d):l}:"0".split(void 0,0)[g]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,i){var r=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,r,i):p.call(String(r),n,i)},function(t,e){var i=c(p,t,this,e,p!==n);if(i.done)return i.value;var u=r(t),f=String(this),g=o(u,RegExp),m=u.unicode,y=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(d?"y":"g"),v=new g(d?u:"^(?:"+u.source+")",y),x=void 0===e?4294967295:e>>>0;if(0===x)return[];if(0===f.length)return null===l(v,f)?[f]:[];for(var w=0,S=0,_=[];S<f.length;){v.lastIndex=d?S:0;var b,P=l(v,d?f:f.slice(S));if(null===P||(b=h(a(v.lastIndex+(d?0:S)),f.length))===w)S=s(f,S,m);else{if(_.push(f.slice(w,S)),_.length===x)return _;for(var C=1;C<=P.length-1;C++)if(_.push(P[C]),_.length===x)return _;S=w=b}}return _.push(f.slice(w)),_}]}))},function(t,e,n){var i=n(4);i(i.P,"Function",{bind:n(103)})},function(t,e,n){"use strict";var i=n(27),r=n(6),o=n(104),s=[].slice,a={},l=function(t,e,n){if(!(e in a)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";a[e]=Function("F,a","return new F("+i.join(",")+")")}return a[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=s.call(arguments,1),a=function(){var i=n.concat(s.call(arguments));return this instanceof a?l(e,i.length,i):o(e,i,t)};return r(e.prototype)&&(a.prototype=e.prototype),a}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(4);i(i.S,"Object",{create:n(24)})},function(t,e,n){n(63)("asyncIterator")},function(t,e,n){"use strict";var i=n(3),r=n(10),o=n(1),s=n(4),a=n(9),l=n(108).KEY,u=n(2),c=n(25),h=n(29),f=n(13),g=n(0),d=n(64),p=n(63),m=n(109),y=n(38),v=n(8),x=n(6),w=n(12),S=n(17),_=n(19),b=n(20),P=n(24),C=n(110),F=n(31),I=n(65),k=n(5),M=n(37),T=F.f,E=k.f,L=C.f,A=i.Symbol,O=i.JSON,R=O&&O.stringify,D=g("_hidden"),j=g("toPrimitive"),V={}.propertyIsEnumerable,B=c("symbol-registry"),G=c("symbols"),N=c("op-symbols"),Z=Object.prototype,z="function"==typeof A&&!!I.f,H=i.QObject,U=!H||!H.prototype||!H.prototype.findChild,W=o&&u((function(){return 7!=P(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=T(Z,e);i&&delete Z[e],E(t,e,n),i&&t!==Z&&E(Z,e,i)}:E,q=function(t){var e=G[t]=P(A.prototype);return e._k=t,e},Y=z&&"symbol"==typeof A.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof A},$=function(t,e,n){return t===Z&&$(N,e,n),v(t),e=_(e,!0),v(n),r(G,e)?(n.enumerable?(r(t,D)&&t[D][e]&&(t[D][e]=!1),n=P(n,{enumerable:b(0,!1)})):(r(t,D)||E(t,D,b(1,{})),t[D][e]=!0),W(t,e,n)):E(t,e,n)},K=function(t,e){v(t);for(var n,i=m(e=S(e)),r=0,o=i.length;o>r;)$(t,n=i[r++],e[n]);return t},X=function(t){var e=V.call(this,t=_(t,!0));return!(this===Z&&r(G,t)&&!r(N,t))&&(!(e||!r(this,t)||!r(G,t)||r(this,D)&&this[D][t])||e)},J=function(t,e){if(t=S(t),e=_(e,!0),t!==Z||!r(G,e)||r(N,e)){var n=T(t,e);return!n||!r(G,e)||r(t,D)&&t[D][e]||(n.enumerable=!0),n}},Q=function(t){for(var e,n=L(S(t)),i=[],o=0;n.length>o;)r(G,e=n[o++])||e==D||e==l||i.push(e);return i},tt=function(t){for(var e,n=t===Z,i=L(n?N:S(t)),o=[],s=0;i.length>s;)!r(G,e=i[s++])||n&&!r(Z,e)||o.push(G[e]);return o};z||(a((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===Z&&e.call(N,n),r(this,D)&&r(this[D],t)&&(this[D][t]=!1),W(this,t,b(1,n))};return o&&U&&W(Z,t,{configurable:!0,set:e}),q(t)}).prototype,"toString",(function(){return this._k})),F.f=J,k.f=$,n(16).f=C.f=Q,n(39).f=X,I.f=tt,o&&!n(15)&&a(Z,"propertyIsEnumerable",X,!0),d.f=function(t){return q(g(t))}),s(s.G+s.W+s.F*!z,{Symbol:A});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)g(et[nt++]);for(var it=M(g.store),rt=0;it.length>rt;)p(it[rt++]);s(s.S+s.F*!z,"Symbol",{for:function(t){return r(B,t+="")?B[t]:B[t]=A(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in B)if(B[e]===t)return e},useSetter:function(){U=!0},useSimple:function(){U=!1}}),s(s.S+s.F*!z,"Object",{create:function(t,e){return void 0===e?P(t):K(P(t),e)},defineProperty:$,defineProperties:K,getOwnPropertyDescriptor:J,getOwnPropertyNames:Q,getOwnPropertySymbols:tt});var ot=u((function(){I.f(1)}));s(s.S+s.F*ot,"Object",{getOwnPropertySymbols:function(t){return I.f(w(t))}}),O&&s(s.S+s.F*(!z||u((function(){var t=A();return"[null]"!=R([t])||"{}"!=R({a:t})||"{}"!=R(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(x(e)||void 0!==t)&&!Y(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Y(e))return e}),i[1]=e,R.apply(O,i)}}),A.prototype[j]||n(7)(A.prototype,j,A.prototype.valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(13)("meta"),r=n(6),o=n(10),s=n(5).f,a=0,l=Object.isExtensible||function(){return!0},u=!n(2)((function(){return l(Object.preventExtensions({}))})),c=function(t){s(t,i,{value:{i:"O"+ ++a,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[i].i},getWeak:function(t,e){if(!o(t,i)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[i].w},onFreeze:function(t){return u&&h.NEED&&l(t)&&!o(t,i)&&c(t),t}}},function(t,e,n){var i=n(37),r=n(65),o=n(39);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var s,a=n(t),l=o.f,u=0;a.length>u;)l.call(t,s=a[u++])&&e.push(s);return e}},function(t,e,n){var i=n(17),r=n(16).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return r(t)}catch(t){return s.slice()}}(t):r(i(t))}},function(t,e,n){var i=n(4);i(i.S+i.F*!n(1),"Object",{defineProperty:n(5).f})}]);